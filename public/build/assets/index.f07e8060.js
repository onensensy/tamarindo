import{h as wt,d as ts,aM as Se,at as qe,l as ke,au as at,s as ie,ar as Fe,aN as He,aO as Me,v as V,j as x,V as Le,y as K,z as t,C as b,O as h,aa as M,ab as te,G as u,P as _,B as e,aP as ss,R as C,aQ as as,aj as q,c as re,n as R,i as Ne,A as o,aR as os,aS as ze,aT as Ke,I as $,a5 as Re,a6 as Ve,x as ne,aF as ft,a9 as de,a7 as Be,Z as E,Y as U,aC as fe,an as ns,ao as _t,F as L,a8 as Oe,q as ae,aU as ls,N,Q as z,aV as rs,aW as cs,aX as is,m as be,w as Te,aG as ut,b as ue,as as yt,k as Z,$ as X,a0 as J,aY as $t,aZ as Dt,a_ as Pt,a1 as us,a$ as Ye,ax as ds,b0 as _s,b1 as ps,D as vs,b2 as fs,b3 as ys,g as We,b4 as ms,b5 as gs,b6 as hs,b7 as pt,aH as bs,b8 as ks,b9 as Ss,ba as Et,bb as ws,bc as It,bd as $s,be as Lt,bf as As,bg as xe,u as vt,bh as xs,aB as Ts,bi as Rt,bj as je,bk as Cs,bl as At,bm as Ds,e as Ue,bn as Ps,bo as Es,bp as Is,bq as Ls,E as Rs,r as xt,br as Vs,aw as dt,a2 as Os,bs as Tt,bt as Fs,bu as Ms,bv as Ns}from"./index.8f0bf197.js";import{u as Ce}from"./useAuthorization.5beda362.js";import{f as Bs,o as Us,a as qs,u as Hs,b as Qs,c as Gs,p as oe,_ as Vt,S as mt,d as gt,e as Ot,g as Ft,h as Mt,i as Nt,j as se,k as Xe,l as Bt,m as Ys,C as Ut}from"./app.be92839b.js";import{B as ve}from"./Btn.abe2bb59.js";import{u as zs,a as qt}from"./useSongMenuMethods.5f7dfc3e.js";import{_ as G}from"./_plugin-vue_export-helper.cdc0426e.js";import{d as ot}from"./downloadService.40931a22.js";import Ks from"./SoundBars.e7c8d9da.js";import{u as Ws,a as js}from"./useUpload.8e7c76aa.js";const Xs={scrollTo(i,c,s,a){if(s<=0||!i)return;const l=(c-i.scrollTop)/s*10;window.setTimeout(()=>{if(i.scrollTop=i.scrollTop+l,i.scrollTop===c){a&&a();return}this.scrollTo(i,c,s-10)},10)}},Js={readAsDataUrl:i=>new Promise((c,s)=>{const a=new FileReader;a.readAsDataURL(i),a.onload=()=>c(a.result),a.onerror=n=>s(n)})},Zs={fetchAll:async()=>await wt.get("genres"),fetchOne:async i=>await wt.get(`genres/${i}`)},ea=["songs","album","artist","playlist","playlist-folder"],ta=(i,c)=>{if(!i.dataTransfer)return;let s=document.querySelector("#dragGhost");s||(s=document.createElement("div"),s.id="dragGhost",document.body.appendChild(s)),s.innerText=c,i.dataTransfer.setDragImage(s,0,0)},et=i=>ea.find(c=>{var s;return(s=i.dataTransfer)==null?void 0:s.types.includes(`application/x-koel.${c}`)}),Qe=i=>({startDragging:(s,a)=>{if(!s.dataTransfer)return;s.dataTransfer.effectAllowed="copyMove";let n,l;switch(i){case"songs":a=ts(a),n=a.length===1?`${a[0].title} by ${a[0].artist_name}`:Se(a,"song"),l=a.map(r=>r.id);break;case"album":a=a,n=`All songs in ${a.name}`,l=a.id;break;case"artist":a=a,n=`All songs by ${a.name}`,l=a.id;break;case"playlist":a=a,n=a.name,l=a.id;break;case"playlist-folder":a=a,n=a.name,l=a.id;break;default:return}s.dataTransfer.setData(`application/x-koel.${i}`,JSON.stringify(l)),ta(s,n)}}),nt=i=>{const c=l=>{const r=et(l);return Boolean(r&&i.includes(r))},s=l=>{var v;const r=et(l);if(!r)return null;try{return JSON.parse((v=l.dataTransfer)==null?void 0:v.getData(`application/x-koel.${r}`))}catch{return null}};return{acceptsDrop:c,getDroppedData:s,resolveDroppedValue:async l=>{try{switch(et(l)){case"playlist":return qe.byId(parseInt(l.dataTransfer.getData("application/x-koel.playlist")));default:return}}catch(r){ke.error(r,l)}},resolveDroppedSongs:async l=>{try{const r=et(l);if(!r)return[];const v=s(l);switch(r){case"songs":return ie.byIds(v);case"album":const d=await He.resolve(v);return d?await ie.fetchForAlbum(d):[];case"artist":const p=await Fe.resolve(v);return p?await ie.fetchForArtist(p):[];case"playlist":const f=qe.byId(v);return f?await ie.fetchForPlaylist(f):[];case"playlist-folder":const y=at.byId(v);return y?await ie.fetchForPlaylistFolder(y):[];default:throw new Error(`Unknown drag type: ${r}`)}}catch(r){return ke.error(r,l),[]}}}},Ht=(i,c,s={})=>{const a=f=>{if(Me(f)&&!f.value)throw new TypeError("Reference element is not defined");return Me(f)?f.value:f},n=Object.assign({placement:"bottom",useArrow:!0,autoTrigger:!0},s);let l,r,v,d;return{setup:()=>{const f=a(i),y=a(c);y.style.display="none";const A=[Bs(),Us(6)];let S;n.useArrow&&(S=document.createElement("div"),S.className="arrow",y.appendChild(S),A.push(Qs({element:S,padding:6})));const T=async()=>await Hs(f,y,{placement:n.placement,middleware:A},S);l=qs(f,y,T),r=async()=>{y.style.display="block",await T()},v=()=>y.style.display="none",d=()=>y.style.display==="none"?r():v(),n.autoTrigger&&(f.addEventListener("mouseenter",r),f.addEventListener("focus",r),f.addEventListener("mouseleave",v),f.addEventListener("blur",v))},teardown:()=>l(),show:()=>r(),hide:()=>v(),trigger:()=>d()}},sa=V({__name:"BtnScrollToTop",setup(i){const c=x(),s=x(!1),a=()=>{var n;return Xs.scrollTo((n=c.value)==null?void 0:n.parentElement,0,500,()=>s.value=!1)};return Le(()=>{var n,l;(l=(n=c.value)==null?void 0:n.parentElement)==null||l.addEventListener("scroll",r=>{s.value=r.target.scrollTop>64})}),(n,l)=>{const r=K("Icon");return t(),b(as,{name:"fade"},{default:h(()=>[M(u("button",{ref_key:"el",ref:c,title:"Scroll to top",type:"button",onClick:a},[_(r,{icon:e(ss)},null,8,["icon"]),C("\xA0 Top ")],512),[[te,s.value]])]),_:1})}}}),aa=G(sa,[["__scopeId","data-v-5877fea3"]]),ht=i=>{const c=x(),s=r=>{const v=r.target;v.scrollTop+v.clientHeight>=v.scrollHeight-32&&i()};let a=0;const n=5,l=async()=>{const r=c.value;if(!r){window.setTimeout(()=>l(),200);return}r.scrollHeight<=r.clientHeight&&a<n&&(a++,await i(),window.setTimeout(()=>l(),200))};return{ToTopButton:aa,scroller:c,scrolling:s,makeScrollable:l}},oa=()=>{const{isAdmin:i}=Ce(),c=q(re.state,"latest_version"),s=q(re.state,"current_version"),a=R(()=>Gs.compare(c.value,s.value,">")),n=R(()=>i.value&&a.value),l=R(()=>`https://github.com/koel/koel/releases/tag/${c.value}`);return{shouldNotifyNewVersion:n,currentVersion:s,latestVersion:c,latestVersionReleaseUrl:l}},na=i=>(Re("data-v-03d4ec64"),i=i(),Ve(),i),la={key:0,class:"text-highlight"},ra=na(()=>u("span",null,"Toggle the song list controls",-1)),ca=V({__name:"ScreenControlsToggle",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(i,{emit:c}){const s=i,a=R({get:()=>s.modelValue,set:n=>c("update:modelValue",n)});return(n,l)=>{const r=K("Icon");return e(Ne).phone?(t(),o("label",la,[M(u("input",{"onUpdate:modelValue":l[0]||(l[0]=v=>a.value=v),type:"checkbox"},null,512),[[os,a.value]]),_(r,{icon:a.value?e(ze):e(Ke),class:"toggle"},null,8,["icon"]),ra])):$("",!0)}}}),ia=G(ca,[["__scopeId","data-v-03d4ec64"]]),Ct=5,ua=V({__name:"VirtualScroller",props:{items:{},itemHeight:{}},emits:["scrolled-to-end","scroll"],setup(i,{emit:c}){const s=i,{items:a,itemHeight:n}=ne(s),l=x(),r=x(0),v=x(0),d=R(()=>a.value.length*n.value),p=R(()=>Math.max(0,Math.floor(v.value/n.value)-Ct)),f=R(()=>p.value*n.value),y=R(()=>{let T=Math.ceil(r.value/n.value)+2*Ct;return T=Math.min(a.value.length-p.value,T),a.value.slice(p.value,p.value+T)}),A=T=>requestAnimationFrame(()=>{v.value=T.target.scrollTop,l.value&&(c("scroll",T),l.value.scrollTop+l.value.clientHeight+n.value>=l.value.scrollHeight&&c("scrolled-to-end"))}),S=new ResizeObserver(T=>T.forEach(F=>r.value=F.contentRect.height));return Le(()=>{S.observe(l.value),r.value=l.value.offsetHeight}),ft(()=>S.unobserve(l.value)),(T,F)=>{const I=de("koel-overflow-fade");return M((t(),o("div",{ref_key:"scroller",ref:l,class:"virtual-scroller",onScrollPassive:A},[u("div",{style:Be({height:`${d.value}px`})},[u("div",{style:Be({transform:`translateY(${f.value}px)`})},[(t(!0),o(E,null,U(y.value,m=>fe(T.$slots,"default",{item:m},void 0,!0)),256))],4)],4)],32)),[[I]])}}}),da=G(ua,[["__scopeId","data-v-ed4fed32"]]),_a=["alt","src"],pa=["title","onClick"],va=V({__name:"SongThumbnail",props:{song:{}},setup(i){const c=i,{song:s}=ne(c),a=()=>{ae.queueIfNotQueued(s.value),oe.play(s.value)},n=R(()=>s.value.playback_state==="Playing"?"Pause":s.value.playback_state==="Paused"?"Resume":"Play"),l=()=>{s.value.playback_state==="Stopped"?a():s.value.playback_state==="Paused"?oe.resume():oe.pause()};return(r,v)=>{const d=K("Icon"),p=de("koel-hide-broken-icon");return t(),o("div",{style:Be({backgroundImage:`url(${e(Oe)})`}),class:"cover"},[M(u("img",{alt:e(s).album_name,src:e(s).album_cover,loading:"lazy"},null,8,_a),[[p]]),u("a",{title:n.value,class:"control",role:"button",onClick:L(l,["prevent"])},[_(d,{icon:e(s).playback_state==="Playing"?e(ns):e(_t),class:"text-highlight"},null,8,["icon"])],8,pa)],4)}}}),Qt=G(va,[["__scopeId","data-v-6601b898"]]),fa=["onDblclick"],ya={class:"track-number"},ma={key:1,class:"text-secondary"},ga={class:"thumbnail"},ha={class:"title-artist"},ba={class:"title text-primary"},ka={class:"artist"},Sa={class:"album"},wa={class:"time"},$a={class:"extra"},Aa=V({__name:"SongListItem",props:{item:{}},setup(i){const c=i,{item:s}=ne(c),a=R(()=>s.value.song),n=R(()=>["Playing","Paused"].includes(a.value.playback_state)),l=ls(a.value.length),r=()=>{ae.queueIfNotQueued(a.value),oe.play(a.value)};return(v,d)=>(t(),o("div",{class:z([{playing:n.value,selected:e(s).selected},"song-item"]),"data-testid":"song-item",tabindex:"0",onDblclick:L(r,["prevent","stop"])},[u("span",ya,[a.value.playback_state==="Playing"?(t(),b(Ks,{key:0})):(t(),o("span",ma,N(a.value.track||""),1))]),u("span",ga,[_(Qt,{song:a.value},null,8,["song"])]),u("span",ha,[u("span",ba,N(a.value.title),1),u("span",ka,N(a.value.artist_name),1)]),u("span",Sa,N(a.value.album_name),1),u("span",wa,N(e(l)),1),u("span",$a,[_(Vt,{song:a.value},null,8,["song"])])],42,fa))}}),xa=["onClick"],Ta={class:"icon"},Ca=V({__name:"SongListSorter",props:{field:{},order:{}},emits:["sort"],setup(i,{emit:c}){const s=i,{field:a,order:n}=ne(s),l=x(),r=x(),v=[{label:"Title",field:"title"},{label:"Artist",field:"artist_name"},{label:"Album",field:"album_name"},{label:"Track & Disc",field:"track"},{label:"Time",field:"length"},{label:"Date Added",field:"created_at"}],{setup:d,teardown:p,trigger:f,hide:y}=Ht(l,r,{placement:"bottom-end",useArrow:!1,autoTrigger:!1}),A=S=>{c("sort",S),y()};return Le(()=>r.value&&d()),ft(()=>p()),(S,T)=>{const F=K("Icon"),I=de("koel-clickaway");return t(),o("div",null,[u("button",{ref_key:"button",ref:l,title:"Sort",onClick:T[0]||(T[0]=L((...m)=>e(f)&&e(f)(...m),["stop"]))},[_(F,{icon:e(rs)},null,8,["icon"])],512),M((t(),o("menu",{ref_key:"menu",ref:r},[(t(),o(E,null,U(v,m=>u("li",{key:m.label,class:z(m.field===e(a)&&"active"),onClick:k=>A(m.field)},[u("span",null,N(m.label),1),u("span",Ta,[e(n)==="asc"?(t(),b(F,{key:0,icon:e(cs)},null,8,["icon"])):(t(),b(F,{key:1,icon:e(is)},null,8,["icon"]))])],10,xa)),64))])),[[I,e(y)]])])}}}),Da=G(Ca,[["__scopeId","data-v-470e0c77"]]),Pa=["onKeydown"],Ea={class:"extra"},Ia=V({__name:"SongList",emits:["press:enter","press:delete","reorder","sort","scroll-breakpoint","scrolled-to-end"],setup(i,{expose:c,emit:s}){const{startDragging:a}=Qe("songs"),{getDroppedData:n,acceptsDrop:l}=nt(["songs"]),[r]=be(mt),[v,d]=be(gt),[p,f]=be(Ot),[y,A]=be(Ft),[S]=be(Mt,[{}]),T=be(Nt,x("")),F=x(),I=x(),m=x([]),k=x([]);Te(k,()=>d(k.value.filter(P=>P.selected).map(P=>P.song)),{deep:!0});const D=R(()=>{const P=T.value.trim().toLowerCase();return P?k.value.filter(O=>{const ee=O.song;return ee.title.toLowerCase().includes(P)||ee.artist_name.toLowerCase().includes(P)||ee.album_artist_name.toLowerCase().includes(P)||ee.album_name.toLowerCase().includes(P)}):k.value});let g=0;const B=P=>{const O=P.target;O.scrollTop>512&&g<512?s("scroll-breakpoint","down"):O.scrollTop<512&&g>512&&s("scroll-breakpoint","up"),g=O.scrollTop},w=()=>{const P=v.value.map(O=>O.id);return r.value.map(O=>({song:O,selected:P.includes(O.id)}))},H=P=>{!S.sortable||(f(P),A(y.value==="asc"?"desc":"asc"),s("sort",P,y.value))},Y=()=>{S.sortable||(m.value=[]),k.value=w()};Te(r,()=>Y(),{deep:!0});const le=()=>{s("press:delete"),j()},W=P=>{s("press:enter",P),j()},Q=()=>k.value.forEach(P=>P.selected=!0),j=()=>k.value.forEach(P=>P.selected=!1),we=P=>(P.ctrlKey||P.metaKey)&&Q(),ge=()=>k.value.map(P=>P.song),De=(P,O)=>{if(Ne.any){Pe(P);return}(O.ctrlKey||O.metaKey)&&Pe(P),O.button===0&&(O.ctrlKey||O.metaKey||O.shiftKey||(j(),Pe(P)),O.shiftKey&&I.value&&Ge(I.value,P))},Pe=P=>{P.selected=!P.selected,I.value=P},Ge=(P,O)=>{const ee=Math.max(0,ue.exports.findIndex(k.value,Ae=>Ae.song.id===P.song.id)),ce=Math.max(0,ue.exports.findIndex(k.value,Ae=>Ae.song.id===O.song.id)),pe=[ee,ce];pe.sort((Ae,es)=>Ae-es);for(let Ae=pe[0];Ae<=pe[1];++Ae)k.value[Ae].selected=!0},_e=(P,O)=>{var ee;P.selected||(j(),P.selected=!0),(ee=F.value)==null||ee.classList.add("dragging"),a(O,v.value)},Ee=P=>{var O;if(!!S.reorderable)return l(P)&&((O=P.target.closest(".song-item"))==null||O.classList.add("droppable")),!1},it=(P,O)=>{var ee,ce;return!S.reorderable||!n(O)||!v.value.length?((ee=F.value)==null||ee.classList.remove("dragging"),$e(O)):((ce=F.value)==null||ce.classList.remove("dragging"),s("reorder",P.song),$e(O))},$e=P=>{var O;return(O=P.target.closest(".song-item"))==null||O.classList.remove("droppable"),!1},Jt=()=>{var P;return(P=F.value)==null?void 0:P.classList.remove("dragging")},Zt=async(P,O)=>{P.selected||(j(),Pe(P),await yt()),Z.emit("SONG_CONTEXT_MENU_REQUESTED",O,v.value)};return c({getAllSongsWithSort:ge}),Le(()=>Y()),(P,O)=>{const ee=K("Icon");return t(),o("div",{ref_key:"wrapper",ref:F,class:"song-list-wrap","data-testid":"song-list",tabindex:"0",onKeydown:[ut(L(le,["prevent","stop"]),["delete"]),ut(L(W,["prevent","stop"]),["enter"]),ut(L(we,["prevent"]),["a"])]},[u("div",{class:z([e(S).sortable?"sortable":"unsortable","song-list-header"])},[u("span",{class:"track-number","data-testid":"header-track-number",role:"button",title:"Sort by track number",onClick:O[0]||(O[0]=ce=>H("track"))},[C(" # "),e(S).sortable?(t(),o(E,{key:0},[e(p)==="track"&&e(y)==="asc"?(t(),b(ee,{key:0,icon:e(Ke),class:"text-highlight"},null,8,["icon"])):$("",!0),e(p)==="track"&&e(y)==="desc"?(t(),b(ee,{key:1,icon:e(ze),class:"text-highlight"},null,8,["icon"])):$("",!0)],64)):$("",!0)]),u("span",{class:"title-artist","data-testid":"header-title",role:"button",title:"Sort by title",onClick:O[1]||(O[1]=ce=>H("title"))},[C(" Title "),e(S).sortable?(t(),o(E,{key:0},[e(p)==="title"&&e(y)==="asc"?(t(),b(ee,{key:0,icon:e(Ke),class:"text-highlight"},null,8,["icon"])):$("",!0),e(p)==="title"&&e(y)==="desc"?(t(),b(ee,{key:1,icon:e(ze),class:"text-highlight"},null,8,["icon"])):$("",!0)],64)):$("",!0)]),u("span",{class:"album","data-testid":"header-album",role:"button",title:"Sort by album",onClick:O[2]||(O[2]=ce=>H("album_name"))},[C(" Album "),e(S).sortable?(t(),o(E,{key:0},[e(p)==="album_name"&&e(y)==="asc"?(t(),b(ee,{key:0,icon:e(Ke),class:"text-highlight"},null,8,["icon"])):$("",!0),e(p)==="album_name"&&e(y)==="desc"?(t(),b(ee,{key:1,icon:e(ze),class:"text-highlight"},null,8,["icon"])):$("",!0)],64)):$("",!0)]),u("span",{class:"time","data-testid":"header-length",role:"button",title:"Sort by song duration",onClick:O[3]||(O[3]=ce=>H("length"))},[C(" Time "),e(S).sortable?(t(),o(E,{key:0},[e(p)==="length"&&e(y)==="asc"?(t(),b(ee,{key:0,icon:e(Ke),class:"text-highlight"},null,8,["icon"])):$("",!0),e(p)==="length"&&e(y)==="desc"?(t(),b(ee,{key:1,icon:e(ze),class:"text-highlight"},null,8,["icon"])):$("",!0)],64)):$("",!0)]),u("span",Ea,[e(S).sortable?(t(),b(Da,{key:0,field:e(p),order:e(y),onSort:H},null,8,["field","order"])):$("",!0)])],2),_(da,{"item-height":64,items:D.value,onScroll:B,onScrolledToEnd:O[5]||(O[5]=ce=>P.$emit("scrolled-to-end"))},{default:h(({item:ce})=>[(t(),b(Aa,{key:ce.song.id,item:ce,draggable:"true",onClick:pe=>De(ce,pe),onDragleave:$e,onDragstart:pe=>_e(ce,pe),onDragenter:L(Ee,["prevent"]),onDragover:O[4]||(O[4]=L(()=>{},["prevent"])),onDrop:L(pe=>it(ce,pe),["prevent"]),onDragend:L(Jt,["prevent"]),onContextmenu:L(pe=>Zt(ce,pe),["prevent"])},null,8,["item","onClick","onDragstart","onDragenter","onDrop","onDragend","onContextmenu"]))]),_:1},8,["items"])],40,Pa)}}}),La={class:"add-to","data-testid":"add-to-menu",tabindex:"0"},Ra={class:"existing-playlists"},Va=["onClick"],Oa=V({__name:"AddToMenu",props:{songs:{},config:{}},emits:["closing"],setup(i,{emit:c}){const s=i,{songs:a,config:n}=ne(s),l=q(ae.state,"songs"),r=ae.current,v=q(qe.state,"playlists"),d=R(()=>v.value.filter(I=>!I.is_smart)),p=()=>c("closing"),{queueSongsAfterCurrent:f,queueSongsToBottom:y,queueSongsToTop:A,addSongsToFavorite:S,addSongsToExistingPlaylist:T,addSongsToNewPlaylist:F}=zs(a,p);return Te(a,()=>a.value.length||p()),(I,m)=>{const k=de("koel-overflow-fade");return t(),o("div",La,[u("section",Ra,[u("p",null,"Add "+N(e(Se)(e(a),"song"))+" to",1),M((t(),o("ul",null,[e(n).queue?(t(),o(E,{key:0},[l.value.length?(t(),o(E,{key:0},[e(r)?(t(),o("li",{key:0,class:"queue-after-current","data-testid":"queue-after-current",tabindex:"0",onClick:m[0]||(m[0]=(...D)=>e(f)&&e(f)(...D))}," After Current Song ")):$("",!0),u("li",{class:"bottom-queue","data-testid":"queue-bottom",tabindex:"0",onClick:m[1]||(m[1]=(...D)=>e(y)&&e(y)(...D))}," Bottom of Queue "),u("li",{class:"top-queue","data-testid":"queue-top",tabindex:"0",onClick:m[2]||(m[2]=(...D)=>e(A)&&e(A)(...D))},"Top of Queue")],64)):(t(),o("li",{key:1,"data-testid":"queue",tabindex:"0",onClick:m[3]||(m[3]=(...D)=>e(y)&&e(y)(...D))},"Queue"))],64)):$("",!0),e(n).favorites?(t(),o("li",{key:1,class:"favorites","data-testid":"add-to-favorites",tabindex:"0",onClick:m[4]||(m[4]=(...D)=>e(S)&&e(S)(...D))}," Favorites ")):$("",!0),(t(!0),o(E,null,U(d.value,D=>(t(),o("li",{key:D.id,class:"playlist","data-testid":"add-to-playlist",tabindex:"0",onClick:g=>e(T)(D)},N(D.name),9,Va))),128))])),[[k]])]),_(ve,{transparent:"",onClick:L(e(F),["prevent"])},{default:h(()=>[C("New Playlist\u2026")]),_:1},8,["onClick"])])}}}),Fa=G(Oa,[["__scopeId","data-v-d73ba4c1"]]),Ma={},Na={class:"btn-group"};function Ba(i,c){return t(),o("span",Na,[fe(i.$slots,"default",{},void 0,!0)])}const tt=G(Ma,[["render",Ba],["__scopeId","data-v-098cd8fb"]]),Ua=Object.freeze(Object.defineProperty({__proto__:null,default:tt},Symbol.toStringTag,{value:"Module"})),qa={class:"wrapper"},Ha=V({__name:"SongListControls",emits:["playAll","playSelected","filter","clearQueue","deletePlaylist","refresh"],setup(i,{emit:c}){const s=X(()=>J(()=>import("./SongListFilter.9ace6316.js"),["assets/SongListFilter.9ace6316.js","assets/SongListFilter.72817c70.css","assets/index.8f0bf197.js","assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/_plugin-vue_export-helper.cdc0426e.js"])),a=za().getSongListControlsConfig(),[n]=be(mt),[l]=be(gt),r=x(),v=x(),d=x(),p=x(!1),f=x(!1),y=R(()=>Boolean(l.value.length)),A=()=>c("playAll",!0),S=()=>c("playSelected",!0),T=()=>c("playAll",!1),F=()=>c("playSelected",!1),I=()=>c("clearQueue"),m=()=>c("deletePlaylist"),k=()=>c("refresh"),D=le=>c("filter",le),g=le=>le.key==="Alt"&&(f.value=!0),B=le=>le.key==="Alt"&&(f.value=!1);let w;Te(y,async le=>{await yt(),le?(w=Ht(v.value.button,d,{autoTrigger:!1}),w.setup()):w==null||w.teardown()},{immediate:!0});const H=()=>{w==null||w.hide(),p.value=!1},Y=()=>{p.value?w==null||w.hide():w==null||w.show(),p.value=!p.value};return Le(()=>{window.addEventListener("keydown",g),window.addEventListener("keyup",B)}),ft(()=>{window.removeEventListener("keydown",g),window.removeEventListener("keyup",B),w==null||w.teardown()}),(le,W)=>{const Q=K("Icon"),j=de("koel-tooltip"),we=de("koel-clickaway");return t(),o("div",{ref_key:"el",ref:r,class:"song-list-controls","data-testid":"song-list-controls"},[u("div",qa,[_(tt,{uppercased:""},{default:h(()=>[f.value?(t(),o(E,{key:0},[e(l).length<2&&e(n).length?(t(),b(ve,{key:0,class:"btn-play-all",orange:"",title:"Play all songs",onClick:L(T,["prevent"])},{default:h(()=>[_(Q,{icon:e(_t),"fixed-width":""},null,8,["icon"]),C(" All ")]),_:1},8,["onClick"])):$("",!0),e(l).length>1?(t(),b(ve,{key:1,class:"btn-play-selected",orange:"",title:"Play selected songs",onClick:L(F,["prevent"])},{default:h(()=>[_(Q,{icon:e(_t),"fixed-width":""},null,8,["icon"]),C(" Selected ")]),_:1},8,["onClick"])):$("",!0)],64)):(t(),o(E,{key:1},[e(l).length<2&&e(n).length?(t(),b(ve,{key:0,class:"btn-shuffle-all","data-testid":"btn-shuffle-all",orange:"",title:"Shuffle all songs",onClick:L(A,["prevent"])},{default:h(()=>[_(Q,{icon:e($t),"fixed-width":""},null,8,["icon"]),C(" All ")]),_:1},8,["onClick"])):$("",!0),e(l).length>1?(t(),b(ve,{key:1,class:"btn-shuffle-selected","data-testid":"btn-shuffle-selected",orange:"",title:"Shuffle selected songs",onClick:L(S,["prevent"])},{default:h(()=>[_(Q,{icon:e($t),"fixed-width":""},null,8,["icon"]),C(" Selected ")]),_:1},8,["onClick"])):$("",!0)],64)),y.value?(t(),b(ve,{key:2,ref_key:"addToButton",ref:v,green:"",onClick:L(Y,["prevent","stop"])},{default:h(()=>[C(N(p.value?"Cancel":"Add To\u2026"),1)]),_:1},8,["onClick"])):$("",!0),e(a).clearQueue?(t(),b(ve,{key:3,red:"",title:"Clear current queue",onClick:L(I,["prevent"])},{default:h(()=>[C("Clear")]),_:1},8,["onClick"])):$("",!0)]),_:1}),e(a).refresh||e(a).deletePlaylist?(t(),b(tt,{key:0},{default:h(()=>[e(a).refresh?M((t(),b(ve,{key:0,green:"",title:"Refresh",onClick:L(k,["prevent"])},{default:h(()=>[_(Q,{icon:e(Dt),"fixed-width":""},null,8,["icon"])]),_:1},8,["onClick"])),[[j]]):$("",!0),e(a).deletePlaylist?M((t(),b(ve,{key:1,class:"del btn-delete-playlist",red:"",title:"Delete this playlist",onClick:L(m,["prevent"])},{default:h(()=>[_(Q,{icon:e(Pt)},null,8,["icon"])]),_:1},8,["onClick"])),[[j]]):$("",!0)]),_:1})):$("",!0),e(a).filter&&e(n).length?(t(),b(tt,{key:1},{default:h(()=>[_(e(s),{onChange:D})]),_:1})):$("",!0)]),M((t(),o("div",{ref_key:"addToMenu",ref:d,class:"menu-wrapper"},[_(Fa,{config:e(a).addTo,songs:e(l),onClosing:H},null,8,["config","songs"])])),[[we,H]])],512)}}}),Qa=G(Ha,[["__scopeId","data-v-e2639880"]]),Ga=V({__name:"ThumbnailStack",props:{thumbnails:{}},setup(i){const c=i,{thumbnails:s}=ne(c),a=R(()=>s.value.length==0?[Oe]:(s.value.length<4?[s.value[0]]:ue.exports.take(s.value,4)).map(l=>l||Oe)),n=R(()=>a.value.length<4?"single":"tiles");return(l,r)=>(t(),o("div",{class:z(["thumbnail-stack",n.value]),style:Be({backgroundImage:`url(${e(Oe)})`})},[(t(!0),o(E,null,U(a.value,v=>(t(),o("span",{style:Be({backgroundImage:`url(${v}`}),"data-testid":"thumbnail"},null,4))),256))],6))}}),Ya=G(Ga,[["__scopeId","data-v-c5cc0264"]]),Je=(i,c={sortable:!0,reorderable:!0})=>{const s=x("");c=us(c);const{isCurrentScreen:a,go:n,onRouteChanged:l}=se();l(w=>{c.reorderable=w.screen==="Queue",c.sortable=!["Queue","RecentlyPlayed","Search.Songs"].includes(w.screen)});const r=x(),v=Ne.phone,d=x([]),p=x(!1),f=x("expanded"),y=w=>{f.value=w==="down"?"collapsed":"expanded"},A=R(()=>ie.getFormattedLength(i.value)),S=R(()=>{const w=i.value.filter(Y=>Y.album_cover),H=ue.exports.sampleSize(w,20).map(Y=>Y.album_cover);return ue.exports.take(Array.from(new Set(H)),4)}),T=()=>r.value.getAllSongsWithSort(),F=w=>{oe.queueAndPlay(T(),w),n("queue")},I=w=>oe.queueAndPlay(d.value,w),m=ue.exports.throttle(w=>s.value=w,200),k=async w=>{if(d.value.length===1){ae.queueIfNotQueued(d.value[0]),await oe.play(d.value[0]);return}w.shiftKey?ae.queueToTop(d.value):ae.queue(d.value),(w.ctrlKey||w.metaKey)&&await oe.play(d.value[0]),n("queue")},D=x((()=>c.sortable?a("Artist","Album")?"track":a("Search.Songs","Queue","RecentlyPlayed")?null:"title":null)()),g=x("asc"),B=(w=D.value,H=g.value)=>{if(!c.sortable||!w)return;D.value=w,g.value=H;let Y=[w];w==="track"?Y=["disc","track","title"]:w==="album_name"?Y.push("artist_name","disc","track","title"):w==="artist_name"&&Y.push("album_name","disc","track","title"),i.value=ue.exports.orderBy(i.value,Y,H)};return Z.on("SONGS_DELETED",w=>i.value=ue.exports.differenceBy(i.value,w,"id")),Ye(mt,i,!1),Ye(gt,d,!1),Ye(Mt,c),Ye(Ot,D),Ye(Ft,g),ds(Nt,s),{SongList:Ia,SongListControls:Qa,ControlsToggle:ia,ThumbnailStack:Ya,songs:i,headerLayout:f,sortField:D,sortOrder:g,duration:A,thumbnails:S,songList:r,selectedSongs:d,showingControls:p,isPhone:v,onPressEnter:k,playAll:F,playSelected:I,applyFilter:m,onScrollBreakpoint:y,sort:B}},za=()=>{const{isCurrentScreen:i}=se();return{getSongListControlsConfig:()=>{const s={play:!0,addTo:{queue:!0,favorites:!0},clearQueue:!1,deletePlaylist:!1,refresh:!1,filter:!1};return s.clearQueue=i("Queue"),s.addTo.queue=!i("Queue"),s.addTo.favorites=!i("Favorites"),s.deletePlaylist=i("Playlist"),s.refresh=i("Playlist"),s.filter=i("Queue","Artist","Album","Favorites","RecentlyPlayed","Playlist","Search.Songs"),s}}},bt=()=>({useLastfm:q(re.state,"use_last_fm"),useYouTube:q(re.state,"use_you_tube"),useAppleMusic:q(re.state,"use_i_tunes"),useSpotify:q(re.state,"use_spotify")}),Ka=["href"],he=V({__name:"SidebarItem",props:{href:{},icon:{type:[Object,Function]},screen:{}},setup(i){const c=i,s=x(!1),{onRouteChanged:a}=se();return a(n=>s.value=n.screen===c.screen),(n,l)=>{const r=K("Icon");return t(),o("li",null,[u("a",{class:z(s.value&&"active"),href:c.href},[_(r,{icon:c.icon,"fixed-width":""},null,8,["icon"]),u("span",null,[fe(n.$slots,"default")])],10,Ka)])}}}),Wa=V({__name:"QueueSidebarItem",setup(i){const{toastWarning:c,toastSuccess:s}=Xe(),{acceptsDrop:a,resolveDroppedSongs:n}=nt(["songs","album","artist","playlist","playlist-folder"]),l=x(!1),r=p=>l.value=a(p),v=()=>l.value=!1,d=async p=>{l.value=!1,p.preventDefault();const f=await n(p)||[];return f.length?(ae.queue(f),s(`Added ${Se(f,"song")} to queue.`)):c("No applicable songs to queue."),!1};return(p,f)=>(t(),b(he,{screen:"Queue",href:"#/queue",icon:e(_s),class:z(l.value&&"droppable"),onDragleave:v,onDragover:L(r,["prevent"]),onDrop:d},{default:h(()=>[C(" Current Queue ")]),_:1},8,["icon","class","onDragover"]))}});var sc={prefix:"fab",iconName:"lastfm",icon:[512,512,[],"f202","M225.8 367.1l-18.8-51s-30.5 34-76.2 34c-40.5 0-69.2-35.2-69.2-91.5 0-72.1 36.4-97.9 72.1-97.9 66.5 0 74.8 53.3 100.9 134.9 18.8 56.9 54 102.6 155.4 102.6 72.7 0 122-22.3 122-80.9 0-72.9-62.7-80.6-115-92.1-25.8-5.9-33.4-16.4-33.4-34 0-19.9 15.8-31.7 41.6-31.7 28.2 0 43.4 10.6 45.7 35.8l58.6-7c-4.7-52.8-41.1-74.5-100.9-74.5-52.8 0-104.4 19.9-104.4 83.9 0 39.9 19.4 65.1 68 76.8 44.9 10.6 79.8 13.8 79.8 45.7 0 21.7-21.1 30.5-61 30.5-59.2 0-83.9-31.1-97.9-73.9-32-96.8-43.6-163-161.3-163C45.7 113.8 0 168.3 0 261c0 89.1 45.7 137.2 127.9 137.2 66.2 0 97.9-31.1 97.9-31.1z"]},ja={prefix:"fab",iconName:"microsoft",icon:[448,512,[],"f3ca","M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"]},ac={prefix:"fab",iconName:"spotify",icon:[496,512,[],"f1bc","M248 8C111.1 8 0 119.1 0 256s111.1 248 248 248 248-111.1 248-248S384.9 8 248 8zm100.7 364.9c-4.2 0-6.8-1.3-10.7-3.6-62.4-37.6-135-39.2-206.7-24.5-3.9 1-9 2.6-11.9 2.6-9.7 0-15.8-7.7-15.8-15.8 0-10.3 6.1-15.2 13.6-16.8 81.9-18.1 165.6-16.5 237 26.2 6.1 3.9 9.7 7.4 9.7 16.5s-7.1 15.4-15.2 15.4zm26.9-65.6c-5.2 0-8.7-2.3-12.3-4.2-62.5-37-155.7-51.9-238.6-29.4-4.8 1.3-7.4 2.6-11.9 2.6-10.7 0-19.4-8.7-19.4-19.4s5.2-17.8 15.5-20.7c27.8-7.8 56.2-13.6 97.8-13.6 64.9 0 127.6 16.1 177 45.5 8.1 4.8 11.3 11 11.3 19.7-.1 10.8-8.5 19.5-19.4 19.5zm31-76.2c-5.2 0-8.4-1.3-12.9-3.9-71.2-42.5-198.5-52.7-280.9-29.7-3.6 1-8.1 2.6-12.9 2.6-13.2 0-23.3-10.3-23.3-23.6 0-13.6 8.4-21.3 17.4-23.9 35.2-10.3 74.6-15.2 117.5-15.2 73 0 149.5 15.2 205.4 47.8 7.8 4.5 12.9 10.7 12.9 22.6 0 13.6-11 23.3-23.2 23.3z"]},Xa={prefix:"fab",iconName:"youtube",icon:[576,512,[61802],"f167","M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"]};const Ja=V({__name:"YouTubeSidebarItem",setup(i){const c=x("");return Z.on("PLAY_YOUTUBE_VIDEO",s=>c.value=s.title),(s,a)=>(t(),b(he,{screen:"YouTube",href:"#/youtube",icon:e(Xa)},{default:h(()=>[C(N(c.value),1)]),_:1},8,["icon"]))}}),Za=["href"],eo=V({__name:"PlaylistSidebarItem",props:{list:{}},setup(i){const c=i,{onRouteChanged:s}=se(),{startDragging:a}=Qe("playlist"),{acceptsDrop:n,resolveDroppedSongs:l}=nt(["songs","album","artist"]),r=x(!1),{addSongsToPlaylist:v}=qt(),{list:d}=ne(c),p=g=>"id"in g,f=g=>g.name==="Favorites",y=g=>g.name==="Recently Played",A=x(!1),S=R(()=>{if(p(d.value))return`#/playlist/${d.value.id}`;if(f(d.value))return"#/favorites";if(y(d.value))return"#/recently-played";throw new Error("Invalid playlist-like type.")}),T=R(()=>y(d.value)?!1:f(d.value)?!0:!d.value.is_smart),F=g=>{p(d.value)&&(g.preventDefault(),Z.emit("PLAYLIST_CONTEXT_MENU_REQUESTED",g,d.value))},I=g=>p(d.value)&&a(g,d.value),m=g=>(!T.value||!n(g)||(g.preventDefault(),r.value=!0),!1),k=()=>r.value=!1,D=async g=>{if(r.value=!1,!T.value||!n(g))return!1;const B=await l(g);return B!=null&&B.length&&(f(d.value)?await We.like(B):p(d.value)&&await v(d.value,B)),!1};return s(g=>{switch(g.screen){case"Favorites":A.value=f(d.value);break;case"RecentlyPlayed":A.value=y(d.value);break;case"Playlist":A.value=d.value.id===parseInt(g.params.id);break;default:A.value=!1;break}}),(g,B)=>{const w=K("Icon");return t(),o("li",{ref:"el",class:z([{droppable:r.value},"playlist"]),draggable:"true",onContextmenu:F,onDragleave:k,onDragover:m,onDragstart:I,onDrop:D},[u("a",{class:z({active:A.value}),href:S.value},[y(e(d))?(t(),b(w,{key:0,icon:e(ps),class:"text-green","fixed-width":""},null,8,["icon"])):f(e(d))?(t(),b(w,{key:1,icon:e(vs),class:"text-maroon","fixed-width":""},null,8,["icon"])):e(d).is_smart?(t(),b(w,{key:2,icon:e(fs),"fixed-width":""},null,8,["icon"])):(t(),b(w,{key:3,icon:e(ys),"fixed-width":""},null,8,["icon"])),u("span",null,N(e(d).name),1)],10,Za)],34)}}});const st=G(eo,[["__scopeId","data-v-5fcb7dd7"]]),to=Object.freeze(Object.defineProperty({__proto__:null,default:st},Symbol.toStringTag,{value:"Module"})),so=["onClick","onContextmenu"],ao={key:0},oo=["onDragleave","onDrop"],no=V({__name:"PlaylistFolderSidebarItem",props:{folder:{}},setup(i){const c=i,s=X(()=>J(()=>Promise.resolve().then(()=>to),void 0)),{folder:a}=ne(c),n=x(!1),l=x(!1),r=x(!1),v=R(()=>qe.byFolder(a.value)),{acceptsDrop:d,resolveDroppedValue:p}=nt(["playlist"]),{startDragging:f}=Qe("playlist-folder"),y=()=>n.value=!n.value,A=g=>f(g,a.value),S=g=>{if(!d(g))return!1;g.preventDefault(),l.value=!0,n.value=!0},T=()=>l.value=!1,F=async g=>{if(l.value=!1,!d(g))return!1;g.preventDefault();const B=await p(g);!B||B.folder_id===a.value.id||await at.addPlaylistToFolder(a.value,B)},I=()=>r.value=!1,m=g=>{if(!d(g))return!1;g.preventDefault(),r.value=!0},k=async g=>{r.value=!1,l.value=!1;const B=await p(g);B.folder_id===a.value.id&&(g.stopPropagation(),await at.removePlaylistFromFolder(a.value,B))},D=g=>Z.emit("PLAYLIST_FOLDER_CONTEXT_MENU_REQUESTED",g,a.value);return(g,B)=>{const w=K("Icon");return t(),o("li",{class:z(["playlist-folder",{droppable:l.value}]),tabindex:"0",draggable:"true",onDragleave:T,onDragover:S,onDragstart:A,onDrop:F},[u("a",{onClick:L(y,["prevent"]),onContextmenu:L(D,["prevent"])},[_(w,{icon:n.value?e(ms):e(gs),"fixed-width":""},null,8,["icon"]),u("span",null,N(e(a).name),1)],40,so),v.value.length?M((t(),o("ul",ao,[(t(!0),o(E,null,U(v.value,H=>(t(),b(e(s),{key:H.id,list:H,class:"sub-item"},null,8,["list"]))),128))],512)),[[te,n.value]]):$("",!0),n.value?(t(),o("div",{key:1,class:z([r.value&&"droppable","hatch"]),onDragover:m,onDragleave:L(I,["prevent"]),onDrop:L(k,["prevent"])},null,42,oo)):$("",!0)],34)}}});const lo=G(no,[["__scopeId","data-v-2383001a"]]),ro={id:"playlists"},co=u("span",null,"Playlists",-1),io=V({__name:"PlaylistSidebarList",setup(i){const c=q(at.state,"folders"),s=q(qe.state,"playlists"),a=q(We.state,"songs"),n=R(()=>s.value.filter(r=>r.folder_id===null)),l=r=>Z.emit("CREATE_NEW_PLAYLIST_CONTEXT_MENU_REQUESTED",r);return(r,v)=>{const d=K("icon");return t(),o("section",ro,[u("h1",null,[co,_(d,{icon:e(hs),class:"control create",role:"button",title:"Create a new playlist or folder",onClick:L(l,["stop","prevent"])},null,8,["icon","onClick"])]),u("ul",null,[_(st,{list:{name:"Favorites",songs:a.value}},null,8,["list"]),_(st,{list:{name:"Recently Played",songs:[]}}),(t(!0),o(E,null,U(c.value,p=>(t(),b(lo,{key:p.id,folder:p},null,8,["folder"]))),128)),(t(!0),o(E,null,U(n.value,p=>(t(),b(st,{key:p.id,list:p},null,8,["list"]))),128))])])}}});const uo=["onSubmit"],_o={class:"icon"},po=["placeholder"],vo={type:"submit",title:"Search"},fo=V({__name:"SearchForm",setup(i){const c=Ne.any?"Search":"Press F to search",{go:s}=se(),a=x(),n=x("");let l=()=>{const d=n.value.trim();d&&Z.emit("SEARCH_KEYWORDS_CHANGED",d)};l=ue.exports.debounce(l,500);const r=()=>{Z.emit("TOGGLE_SIDEBAR"),s("search")},v=()=>Ne.any||s("search");return Z.on("FOCUS_SEARCH_FIELD",()=>{var d,p;(d=a.value)==null||d.focus(),(p=a.value)==null||p.select()}),(d,p)=>{const f=K("Icon");return t(),o("form",{id:"searchForm",role:"search",onSubmit:L(r,["prevent"])},[u("span",_o,[_(f,{icon:e(pt)},null,8,["icon"])]),M(u("input",{ref_key:"input",ref:a,"onUpdate:modelValue":p[0]||(p[0]=y=>n.value=y),class:z({dirty:n.value}),placeholder:e(c),autocorrect:"false",name:"q",required:"",spellcheck:"false",type:"search",onFocus:v,onInput:p[1]||(p[1]=(...y)=>e(l)&&e(l)(...y))},null,42,po),[[bs,n.value]]),u("button",vo,[_(f,{icon:e(pt)},null,8,["icon"])])],40,uo)}}});const Gt=i=>(Re("data-v-e11001d9"),i=i(),Ve(),i),yo={class:"music"},mo=Gt(()=>u("h1",null,"Your Music",-1)),go={class:"menu"},ho={key:0,class:"manage"},bo=Gt(()=>u("h1",null,"Manage",-1)),ko={class:"menu"},So=V({__name:"Sidebar",setup(i){const{onRouteChanged:c}=se(),{useYouTube:s}=bt(),{isAdmin:a}=Ce(),n=x(!1),l=x(!1),r=R(()=>s.value&&l.value),v=()=>n.value=!1;return c(d=>n.value=!1),Z.on("TOGGLE_SIDEBAR",()=>n.value=!n.value).on("PLAY_YOUTUBE_VIDEO",d=>l.value=!0),(d,p)=>{const f=de("koel-clickaway");return M((t(),o("nav",{id:"sidebar",class:z([{showing:n.value},"side side-nav"])},[_(fo),u("section",yo,[mo,u("ul",go,[_(he,{screen:"Home",href:"#/home",icon:e(ks)},{default:h(()=>[C("Home")]),_:1},8,["icon"]),_(Wa),_(he,{screen:"Songs",href:"#/songs",icon:e(Ss)},{default:h(()=>[C("All Songs")]),_:1},8,["icon"]),_(he,{screen:"Albums",href:"#/albums",icon:e(Et)},{default:h(()=>[C("Albums")]),_:1},8,["icon"]),_(he,{screen:"Artists",href:"#/artists",icon:e(ws)},{default:h(()=>[C("Artists")]),_:1},8,["icon"]),_(he,{screen:"Genres",href:"#/genres",icon:e(It)},{default:h(()=>[C("Genres")]),_:1},8,["icon"]),M(_(Ja,null,null,512),[[te,r.value]])])]),_(io),e(a)?(t(),o("section",ho,[bo,u("ul",ko,[_(he,{screen:"Settings",href:"#/settings",icon:e($s)},{default:h(()=>[C("Settings")]),_:1},8,["icon"]),_(he,{screen:"Upload",href:"#/upload",icon:e(Lt)},{default:h(()=>[C("Upload")]),_:1},8,["icon"]),_(he,{screen:"Users",href:"#/users",icon:e(As)},{default:h(()=>[C("Users")]),_:1},8,["icon"])])])):$("",!0)],2)),[[f,v]])}}});const wo=G(So,[["__scopeId","data-v-e11001d9"]]),$o=["onContextmenu","onDblclick"],Ao={class:"details"},xo={class:"by text-secondary"},To=["href"],Co=V({__name:"SongCard",props:{song:{}},setup(i){const c=i,{song:s}=ne(c),{startDragging:a}=Qe("songs"),n=v=>Z.emit("SONG_CONTEXT_MENU_REQUESTED",v,s.value),l=v=>a(v,[s.value]),r=()=>{ae.queueIfNotQueued(s.value),oe.play(s.value)};return(v,d)=>(t(),o("article",{class:z({playing:e(s).playback_state==="Playing"||e(s).playback_state==="Paused"}),draggable:"true",tabindex:"0",onDragstart:l,onContextmenu:L(n,["prevent"]),onDblclick:L(r,["prevent"])},[_(Qt,{song:e(s)},null,8,["song"]),u("main",null,[u("div",Ao,[u("h3",null,N(e(s).title),1),u("p",xo,[u("a",{href:`#/artist/${e(s).artist_id}`},N(e(s).artist_name),9,To),C(" - "+N(e(Se)(e(s).play_count,"play")),1)])]),_(Vt,{song:e(s)},null,8,["song"])])],42,$o))}});const lt=G(Co,[["__scopeId","data-v-9ed31c4b"]]);const Do={},Yt=i=>(Re("data-v-381f338d"),i=i(),Ve(),i),Po={class:"skeleton"},Eo=Yt(()=>u("aside",{class:"pulse"},null,-1)),Io=Yt(()=>u("main",null,[u("div",{class:"details"},[u("h3",{class:"pulse"}),u("p",{class:"pulse"})])],-1)),Lo=[Eo,Io];function Ro(i,c){return t(),o("article",Po,Lo)}const rt=G(Do,[["render",Ro],["__scopeId","data-v-381f338d"]]),Vo=u("h1",null,"Most Played",-1),Oo={key:0,class:"top-song-list"},Fo={key:0,class:"top-song-list"},Mo={key:1,class:"text-secondary"},No=V({__name:"MostPlayedSongs",props:{loading:{type:Boolean,default:!1}},setup(i){const c=i,{loading:s}=ne(c),a=q(xe.state,"mostPlayedSongs");return(n,l)=>(t(),o("section",null,[Vo,e(s)?(t(),o("ol",Oo,[(t(),o(E,null,U(3,r=>u("li",{key:r},[_(rt)])),64))])):(t(),o(E,{key:1},[a.value.length?(t(),o("ol",Fo,[(t(!0),o(E,null,U(a.value,r=>(t(),o("li",{key:r.id},[_(lt,{song:r},null,8,["song"])]))),128))])):(t(),o("p",Mo,"You don\u2019t seem to have been playing."))],64))]))}}),Bo={class:"recent"},Uo={key:0,class:"recent-song-list"},qo={key:0,class:"recent-song-list"},Ho={key:1,class:"text-secondary"},Qo=V({__name:"RecentlyPlayedSongs",props:{loading:{type:Boolean,default:!1}},setup(i){const c=i,{go:s}=se(),{loading:a}=ne(c),n=q(xe.state,"recentlyPlayed"),l=()=>s("recently-played");return(r,v)=>(t(),o("section",Bo,[u("h1",null,[C(" Recently Played "),n.value.length?(t(),b(ve,{key:0,orange:"",rounded:"",small:"",onClick:L(l,["prevent"])},{default:h(()=>[C(" View All ")]),_:1},8,["onClick"])):$("",!0)]),e(a)?(t(),o("ol",Uo,[(t(),o(E,null,U(3,d=>u("li",{key:d},[_(rt)])),64))])):(t(),o(E,{key:1},[n.value.length?(t(),o("ol",qo,[(t(!0),o(E,null,U(n.value,d=>(t(),o("li",{key:d.id},[_(lt,{song:d},null,8,["song"])]))),128))])):(t(),o("p",Ho,"No songs played as of late."))],64))]))}}),Go=i=>(Re("data-v-28d7f4bb"),i=i(),Ve(),i),Yo=["alt","src"],zo=["onClick","onDragenter","onDragleave","onDrop"],Ko={class:"hidden"},Wo=Go(()=>u("span",{class:"icon"},null,-1)),jo=V({__name:"AlbumArtistThumbnail",props:{entity:{}},setup(i){const c=i,s=["image/jpeg","image/gif","image/png","image/webp"],{toastSuccess:a}=Xe(),{go:n}=se(),{entity:l}=ne(c),r=x(!1);q(vt.state,"current");const v=R(()=>l.value.type==="albums"),d=R(()=>v.value?["disc","track"]:["album_id","disc","track"]),p=R(()=>v.value?l.value.cover||Oe:l.value.image||Oe),f=R(()=>v.value?`Play all songs in the album ${l.value.name}`:`Play all songs by ${l.value.name}`),{isAdmin:y}=Ce(),A=async m=>{const k=v.value?await ie.fetchForAlbum(l.value):await ie.fetchForArtist(l.value);if(m.altKey){ae.queue(ue.exports.orderBy(k,d.value)),a("Songs added to queue.");return}oe.queueAndPlay(k),n("queue")},S=()=>r.value=y.value,T=()=>r.value=!1,F=m=>!m.dataTransfer||!m.dataTransfer.items||m.dataTransfer.items.length!==1||m.dataTransfer.items[0].kind!=="file"?!1:s.includes(m.dataTransfer.items[0].getAsFile().type),I=async m=>{if(r.value=!1,!!y.value&&!!F(m))try{const k=await Js.readAsDataUrl(m.dataTransfer.files[0]);v.value?(l.value.cover=k,await He.uploadCover(l.value,k)):(l.value.image=k,await Fe.uploadImage(l.value,k))}catch(k){ke.error(k)}};return(m,k)=>{const D=de("koel-hide-broken-icon");return t(),o("span",{class:z([{droppable:r.value},"cover"]),style:Be({backgroundImage:`url(${e(Oe)})`}),"data-testid":"album-artist-thumbnail"},[M(u("img",{alt:e(l).name,src:p.value,loading:"lazy"},null,8,Yo),[[D]]),u("a",{class:"control control-play",role:"button",onClick:L(A,["prevent"]),onDragenter:L(S,["prevent"]),onDragleave:L(T,["prevent"]),onDrop:L(I,["prevent"]),onDragover:k[0]||(k[0]=L(()=>{},["prevent"]))},[u("span",Ko,N(f.value),1),Wo],40,zo)],6)}}});const Xo=G(jo,[["__scopeId","data-v-28d7f4bb"]]),Jo=["onContextmenu"],Zo={class:"name"},en={class:"meta"},tn=V({__name:"ArtistAlbumCard",props:{layout:{default:"full"},entity:{}},emits:["dblclick","dragstart","contextmenu"],setup(i,{emit:c}){const s=()=>c("dblclick"),a=l=>c("dragstart",l),n=l=>c("contextmenu",l);return(l,r)=>(t(),o("article",{class:z(["item",l.layout]),draggable:"true",tabindex:"0",onDblclick:s,onDragstart:a,onContextmenu:L(n,["prevent"])},[_(Xo,{entity:l.entity},null,8,["entity"]),u("footer",null,[u("div",Zo,[fe(l.$slots,"name",{},void 0,!0)]),u("p",en,[fe(l.$slots,"meta",{},void 0,!0)])])],42,Jo))}});const zt=G(tn,[["__scopeId","data-v-7d4f5f94"]]),sn=["href"],an=["href"],on={key:1,class:"text-secondary"},nn=["title","onClick"],ln=["title","onClick"],ct=V({__name:"AlbumCard",props:{album:{},layout:{default:"full"}},setup(i){const c=i,{go:s}=se(),{startDragging:a}=Qe("album"),{album:n,layout:l}=ne(c),r=q(re.state,"allow_download"),v=R(()=>Fe.isStandard(n.value.artist_id)),d=R(()=>!He.isUnknown(n.value)),p=async()=>{oe.queueAndPlay(await ie.fetchForAlbum(n.value),!0),s("queue")},f=()=>ot.fromAlbum(n.value),y=S=>a(S,n.value),A=S=>Z.emit("ALBUM_CONTEXT_MENU_REQUESTED",S,n.value);return(S,T)=>d.value?(t(),b(zt,{key:0,entity:e(n),title:`${e(n).name} by ${e(n).artist_name}`,layout:e(l),onContextmenu:A,onDblclick:p,onDragstart:y},{name:h(()=>[u("a",{href:`#/album/${e(n).id}`,class:"text-normal","data-testid":"name"},N(e(n).name),9,sn),v.value?(t(),o("a",{key:0,href:`#/artist/${e(n).artist_id}`},N(e(n).artist_name),9,an)):(t(),o("span",on,N(e(n).artist_name),1))]),meta:h(()=>[u("a",{title:`Shuffle all songs in the album ${e(n).name}`,class:"shuffle-album",role:"button",onClick:L(p,["prevent"])}," Shuffle ",8,nn),r.value?(t(),o("a",{key:0,title:`Download all songs in the album ${e(n).name}`,class:"download-album",role:"button",onClick:L(f,["prevent"])}," Download ",8,ln)):$("",!0)]),_:1},8,["entity","title","layout"])):$("",!0)}}),Kt=i=>(Re("data-v-5c5eaffc"),i=i(),Ve(),i),rn=Kt(()=>u("aside",{class:"thumbnail pulse"},null,-1)),cn=Kt(()=>u("footer",null,[u("p",{class:"name pulse"}),u("p",{class:"artist pulse"}),u("p",{class:"meta pulse"})],-1)),un=[rn,cn],dn=V({__name:"ArtistAlbumCardSkeleton",props:{layout:{default:"full"}},setup(i){return(c,s)=>(t(),o("article",{class:z(["skeleton",c.layout])},un,2))}});const Ie=G(dn,[["__scopeId","data-v-5c5eaffc"]]),oc=Object.freeze(Object.defineProperty({__proto__:null,default:Ie},Symbol.toStringTag,{value:"Module"})),_n=u("h1",null,"New Albums",-1),pn={key:0,class:"recently-added-album-list"},vn={key:0,class:"recently-added-album-list"},fn={key:1,class:"text-secondary"},yn=V({__name:"RecentlyAddedAlbums",props:{loading:{type:Boolean,default:!1}},setup(i){const c=i,{loading:s}=ne(c),a=q(xe.state,"recentlyAddedAlbums");return(n,l)=>(t(),o("section",null,[_n,e(s)?(t(),o("ol",pn,[(t(),o(E,null,U(2,r=>u("li",{key:r},[_(Ie,{layout:"compact"})])),64))])):(t(),o(E,{key:1},[a.value.length?(t(),o("ol",vn,[(t(!0),o(E,null,U(a.value,r=>(t(),o("li",{key:r.id},[_(ct,{album:r,layout:"compact"},null,8,["album"])]))),128))])):(t(),o("p",fn,"No albums added yet."))],64))]))}}),mn=u("h1",null,"New Songs",-1),gn={key:0,class:"recently-added-song-list"},hn={key:0,class:"recently-added-song-list"},bn={key:1,class:"text-secondary"},kn=V({__name:"RecentlyAddedSongs",props:{loading:{type:Boolean,default:!1}},setup(i){const c=i,{loading:s}=ne(c),a=q(xe.state,"recentlyAddedSongs");return(n,l)=>(t(),o("section",null,[mn,e(s)?(t(),o("ol",gn,[(t(),o(E,null,U(3,r=>u("li",{key:r},[_(rt)])),64))])):(t(),o(E,{key:1},[a.value.length?(t(),o("ol",hn,[(t(!0),o(E,null,U(a.value,r=>(t(),o("li",{key:r.id},[_(lt,{song:r},null,8,["song"])]))),128))])):(t(),o("p",bn,"No songs added so far."))],64))]))}}),Sn=["href"],wn=["title","onClick"],$n=["title","onClick"],kt=V({__name:"ArtistCard",props:{artist:{},layout:{default:"full"}},setup(i){const c=i,{go:s}=se(),{startDragging:a}=Qe("artist"),{artist:n,layout:l}=ne(c),r=q(re.state,"allow_download"),v=R(()=>Fe.isStandard(n.value)),d=async()=>{oe.queueAndPlay(await ie.fetchForArtist(n.value),!0),s("queue")},p=()=>ot.fromArtist(n.value),f=A=>a(A,n.value),y=A=>Z.emit("ARTIST_CONTEXT_MENU_REQUESTED",A,n.value);return(A,S)=>v.value?(t(),b(zt,{key:0,entity:e(n),layout:e(l),title:e(n).name,onContextmenu:y,onDblclick:d,onDragstart:f},{name:h(()=>[u("a",{href:`#/artist/${e(n).id}`,class:"text-normal","data-testid":"name"},N(e(n).name),9,Sn)]),meta:h(()=>[u("a",{title:`Shuffle all songs by ${e(n).name}`,class:"shuffle-artist",role:"button",onClick:L(d,["prevent"])}," Shuffle ",8,wn),r.value?(t(),o("a",{key:0,title:`Download all songs by ${e(n).name}`,class:"download-artist",role:"button",onClick:L(p,["prevent"])}," Download ",8,$n)):$("",!0)]),_:1},8,["entity","layout","title"])):$("",!0)}}),An=u("h1",null,"Top Artists",-1),xn={key:0,class:"two-cols top-album-list"},Tn={key:0,class:"two-cols top-artist-list"},Cn={key:1,class:"text-secondary"},Dn=V({__name:"MostPlayedArtists",props:{loading:{type:Boolean,default:!1}},setup(i){const c=i,{loading:s}=ne(c),a=q(xe.state,"mostPlayedArtists");return(n,l)=>(t(),o("section",null,[An,e(s)?(t(),o("ol",xn,[(t(),o(E,null,U(4,r=>u("li",{key:r},[_(Ie,{layout:"compact"})])),64))])):(t(),o(E,{key:1},[a.value.length?(t(),o("ol",Tn,[(t(!0),o(E,null,U(a.value,r=>(t(),o("li",{key:r.id},[_(kt,{artist:r,layout:"compact"},null,8,["artist"])]))),128))])):(t(),o("p",Cn,"No artists found."))],64))]))}}),Pn=u("h1",null,"Top Albums",-1),En={key:0,class:"two-cols top-album-list"},In={key:0,class:"two-cols top-album-list"},Ln={key:1,class:"text-secondary"},Rn=V({__name:"MostPlayedAlbums",props:{loading:{type:Boolean,default:!1}},setup(i){const c=i,{loading:s}=ne(c),a=q(xe.state,"mostPlayedAlbums");return(n,l)=>(t(),o("section",null,[Pn,e(s)?(t(),o("ol",En,[(t(),o(E,null,U(4,r=>u("li",{key:r},[_(Ie,{layout:"compact"})])),64))])):(t(),o(E,{key:1},[a.value.length?(t(),o("ol",In,[(t(!0),o(E,null,U(a.value,r=>(t(),o("li",{key:r.id},[_(ct,{album:r,layout:"compact"},null,8,["album"])]))),128))])):(t(),o("p",Ln,"No albums found."))],64))]))}}),Vn={class:"thumbnail-wrapper"},On={class:"heading-wrapper"},Fn={class:"name"},Mn={class:"meta text-secondary"},Nn=V({__name:"ScreenHeader",props:{layout:{default:"expanded"},disabled:{type:Boolean,default:!1}},setup(i){return(c,s)=>(t(),o("header",{class:z(["screen-header",[c.layout,c.disabled?"disabled":""]])},[u("aside",Vn,[fe(c.$slots,"thumbnail")]),u("main",null,[u("div",On,[u("h1",Fn,[fe(c.$slots,"default")]),u("span",Mn,[fe(c.$slots,"meta")])]),fe(c.$slots,"controls")])],2))}});const me=G(Nn,[["__scopeId","data-v-71fdb33d"]]);const Bn={},Un={class:"screen-empty-state","data-testid":"screen-empty-state"},qn={class:"jumbo-icon"},Hn={class:"text"};function Qn(i,c){return t(),o("div",Un,[u("div",null,[u("span",qn,[fe(i.$slots,"icon",{},()=>[C("\u2615\uFE0F")])]),u("div",Hn,[fe(i.$slots,"default",{},()=>[C("Placeholder text goes here.")])])])])}const ye=G(Bn,[["render",Qn]]),Gn={id:"homeWrapper"},Yn={class:"secondary d-block"},zn={class:"two-cols"},Kn={class:"two-cols"},Wn=V({__name:"HomeScreen",setup(i){const{ToTopButton:c,scrolling:s}=ht(()=>Ts()),{isAdmin:a}=Ce(),{showErrorDialog:n}=Bt(),l=["Oh hai!","Hey, %s!","Howdy, %s!","Yo!","How\u2019s it going, %s?","Sup, %s?","How\u2019s life, %s?","How\u2019s your day, %s?","How have you been, %s?"],r=R(()=>vt.current?ue.exports.sample(l).replace("%s",vt.current.name):""),v=R(()=>re.state.song_length===0),d=x(!1);let p=!1;return Z.on("SONGS_DELETED",()=>xe.refresh()).on("SONGS_UPDATED",()=>xe.refresh()),se().onScreenActivated("Home",async()=>{if(!p){d.value=!0;try{await xe.init(),p=!0}catch(f){n("Failed to load home screen data. Please try again.","Error"),ke.error(f)}finally{d.value=!1}}}),(f,y)=>{const A=K("Icon"),S=de("koel-overflow-fade");return t(),o("section",Gn,[_(me,{layout:"collapsed"},{default:h(()=>[C(N(r.value),1)]),_:1}),M((t(),o("div",{class:"main-scroll-wrap",onScroll:y[0]||(y[0]=(...T)=>e(s)&&e(s)(...T))},[v.value?(t(),b(ye,{key:0},{icon:h(()=>[_(A,{icon:e(xs)},null,8,["icon"])]),default:h(()=>[C(" No songs found. "),u("span",Yn,N(e(a)?"Have you set up your library yet?":"Contact your administrator to set up your library."),1)]),_:1})):(t(),o(E,{key:1},[u("div",zn,[_(No,{"data-testid":"most-played-songs",loading:d.value},null,8,["loading"]),_(Qo,{"data-testid":"recently-played-songs",loading:d.value},null,8,["loading"])]),u("div",Kn,[_(yn,{"data-testid":"recently-added-albums",loading:d.value},null,8,["loading"]),_(kn,{"data-testid":"recently-added-songs",loading:d.value},null,8,["loading"])]),_(Dn,{"data-testid":"most-played-artists",loading:d.value},null,8,["loading"]),_(Rn,{"data-testid":"most-played-albums",loading:d.value},null,8,["loading"]),_(e(c))],64))],32)),[[S]])])}}});const jn={},Xn={class:"skeleton"},Jn=Rt('<div class="song-list-header" data-v-3496977f><span class="track-number" data-v-3496977f><span class="text" data-v-3496977f></span></span><span class="title" data-v-3496977f><span class="text" data-v-3496977f></span></span><span class="artist" data-v-3496977f><span class="text" data-v-3496977f></span></span><span class="album" data-v-3496977f><span class="text" data-v-3496977f></span></span><span class="time" data-v-3496977f><span class="text" data-v-3496977f></span></span><span class="favorite" data-v-3496977f></span></div>',1),Zn=Rt('<span class="track-number" data-v-3496977f><span class="text pulse" data-v-3496977f></span></span><span class="title" data-v-3496977f><span class="thumbnail pulse" data-v-3496977f></span><span class="text pulse" data-v-3496977f></span></span><span class="artist" data-v-3496977f><span class="text pulse" data-v-3496977f></span></span><span class="album" data-v-3496977f><span class="text pulse" data-v-3496977f></span></span><span class="time" data-v-3496977f><span class="text pulse" data-v-3496977f></span></span><span class="favorite" data-v-3496977f><span class="text pulse" data-v-3496977f></span></span>',6),el=[Zn];function tl(i,c){return t(),o("div",Xn,[Jn,(t(),o(E,null,U(40,s=>u("div",{key:s,class:"song-item"},el)),64))])}const Ze=G(jn,[["render",tl],["__scopeId","data-v-3496977f"]]),sl={id:"queueWrapper"},al={key:0,class:"d-block secondary"},ol=["onClick"],nl=V({__name:"QueueScreen",setup(i){const{go:c}=se(),{showErrorDialog:s}=Bt(),{SongList:a,SongListControls:n,ControlsToggle:l,ThumbnailStack:r,headerLayout:v,songs:d,songList:p,duration:f,thumbnails:y,selectedSongs:A,showingControls:S,isPhone:T,playSelected:F,applyFilter:I,onScrollBreakpoint:m}=Je(q(ae.state,"songs")),k=x(!1),D=R(()=>re.state.song_count>0),g=async(W=!0)=>{oe.queueAndPlay(d.value,W),c("queue")},B=async()=>{try{k.value=!0,await ae.fetchRandom(),await oe.playFirstInQueue()}catch(W){s("Failed to fetch songs to play. Please try again.","Error"),ke.error(W)}finally{k.value=!1}},w=()=>{oe.stop(),ae.clear()},H=()=>{var Q;if(!A.value.length)return;const W=(Q=ae.current)==null?void 0:Q.id;ae.unqueue(A.value),W&&A.value.find(j=>j.id===W)&&oe.playNext()},Y=()=>A.value.length&&oe.play(A.value[0]),le=W=>ae.move(A.value,W);return Z.on("SONG_QUEUED_FROM_ROUTE",async W=>{let Q;try{if(k.value=!0,Q=await ie.resolve(W),!Q)throw new Error("Song not found")}catch(j){s("Song not found. Please double check and try again.","Error"),ke.error(j);return}finally{k.value=!1}ae.queueIfNotQueued(Q),await oe.play(Q)}),(W,Q)=>{const j=K("Icon");return t(),o("section",sl,[_(me,{layout:e(d).length===0?"collapsed":e(v)},je({thumbnail:h(()=>[_(e(r),{thumbnails:e(y)},null,8,["thumbnails"])]),controls:h(()=>[e(d).length&&(!e(T)||e(S))?(t(),b(e(n),{key:0,onFilter:e(I),onClearQueue:w,onPlayAll:g,onPlaySelected:e(F)},null,8,["onFilter","onPlaySelected"])):$("",!0)]),default:h(()=>[C(" Current Queue "),_(e(l),{modelValue:e(S),"onUpdate:modelValue":Q[0]||(Q[0]=we=>Me(S)?S.value=we:null)},null,8,["modelValue"])]),_:2},[e(d).length?{name:"meta",fn:h(()=>[u("span",null,N(e(Se)(e(d),"song")),1),u("span",null,N(e(f)),1)]),key:"0"}:void 0]),1032,["layout"]),k.value?(t(),b(Ze,{key:0})):$("",!0),e(d).length?(t(),b(e(a),{key:1,ref_key:"songList",ref:p,onReorder:le,"onPress:delete":H,"onPress:enter":Y,onScrollBreakpoint:e(m)},null,8,["onScrollBreakpoint"])):(t(),b(ye,{key:2},{icon:h(()=>[_(j,{icon:e(Cs)},null,8,["icon"])]),default:h(()=>[C(" No songs queued. "),D.value?(t(),o("span",al,[C(" How about "),u("a",{class:"start",onClick:L(B,["prevent"])},"playing some random songs",8,ol),C("? ")])):$("",!0)]),_:1}))])}}}),Wt=i=>(Re("data-v-ce499171"),i=i(),Ve(),i),ll={class:"view-modes"},rl=Wt(()=>u("span",{class:"hidden"},"View as thumbnails",-1)),cl=Wt(()=>u("span",{class:"hidden"},"View as list",-1)),il=V({__name:"ViewModeSwitch",props:{modelValue:{default:"thumbnails"}},emits:["update:modelValue"],setup(i,{emit:c}){const s=i,a=R({get:()=>s.modelValue,set:n=>c("update:modelValue",n)});return(n,l)=>{const r=K("Icon"),v=de("koel-tooltip");return t(),o("span",ll,[M((t(),o("label",{class:z([{active:a.value==="thumbnails"},"thumbnails"]),"data-testid":"view-mode-thumbnail",title:"View as thumbnails"},[M(u("input",{"onUpdate:modelValue":l[0]||(l[0]=d=>a.value=d),class:"hidden",name:"view-mode",type:"radio",value:"thumbnails"},null,512),[[At,a.value]]),_(r,{icon:e(ja)},null,8,["icon"]),rl],2)),[[v]]),M((t(),o("label",{class:z([{active:a.value==="list"},"list"]),"data-testid":"view-mode-list",title:"View as list"},[M(u("input",{"onUpdate:modelValue":l[1]||(l[1]=d=>a.value=d),class:"hidden",name:"view-mode",type:"radio",value:"list"},null,512),[[At,a.value]]),_(r,{icon:e(Ds)},null,8,["icon"]),cl],2)),[[v]])])}}});const jt=G(il,[["__scopeId","data-v-ce499171"]]),ul={id:"albumsWrapper"},dl={class:"secondary d-block"},_l=V({__name:"AlbumListScreen",setup(i){const{isAdmin:c}=Ce(),s=x("thumbnails"),a=q(He.state,"albums"),{ToTopButton:n,scroller:l,scrolling:r,makeScrollable:v}=ht(async()=>await F());Te(s,()=>Ue.albumsViewMode=s.value);let d=!1;const p=x(!1),f=x(1),y=R(()=>re.state.song_length===0),A=R(()=>s.value==="thumbnails"?"full":"compact"),S=R(()=>f.value!==null),T=R(()=>p.value&&a.value.length===0),F=async()=>{p.value||!S.value||(p.value=!0,f.value=await He.paginate(f.value),p.value=!1)};return se().onScreenActivated("Albums",async()=>{if(!y.value&&!d){s.value=Ue.albumsViewMode||"thumbnails",d=!0;try{await v()}catch(I){ke.error(I),Xe().toastError("Failed to load albums."),d=!1}}}),(I,m)=>{const k=K("Icon"),D=de("koel-overflow-fade");return t(),o("section",ul,[_(me,{layout:"collapsed"},{controls:h(()=>[_(jt,{modelValue:s.value,"onUpdate:modelValue":m[0]||(m[0]=g=>s.value=g)},null,8,["modelValue"])]),default:h(()=>[C(" Albums ")]),_:1}),y.value?(t(),b(ye,{key:0},{icon:h(()=>[_(k,{icon:e(Et)},null,8,["icon"])]),default:h(()=>[C(" No albums found. "),u("span",dl,N(e(c)?"Have you set up your library yet?":"Contact your administrator to set up your library."),1)]),_:1})):M((t(),o("div",{key:1,ref_key:"scroller",ref:l,class:z([`as-${s.value}`,"albums main-scroll-wrap"]),"data-testid":"album-list",onScroll:m[1]||(m[1]=(...g)=>e(r)&&e(r)(...g))},[T.value?(t(),o(E,{key:0},U(10,g=>_(Ie,{key:g,layout:A.value},null,8,["layout"])),64)):(t(),o(E,{key:1},[(t(!0),o(E,null,U(a.value,g=>(t(),b(ct,{key:g.id,album:g,layout:A.value},null,8,["album","layout"]))),128)),_(e(n))],64))],34)),[[D]])])}}});const pl={id:"artistsWrapper"},vl={class:"secondary d-block"},fl=V({__name:"ArtistListScreen",setup(i){const{isAdmin:c}=Ce(),s=x("thumbnails"),a=q(Fe.state,"artists"),{ToTopButton:n,scroller:l,scrolling:r,makeScrollable:v}=ht(async()=>await F());Te(s,()=>Ue.artistsViewMode=s.value);let d=!1;const p=x(!1),f=x(1),y=R(()=>re.state.song_length===0),A=R(()=>s.value==="thumbnails"?"full":"compact"),S=R(()=>f.value!==null),T=R(()=>p.value&&a.value.length===0),F=async()=>{p.value||!S.value||(p.value=!0,f.value=await Fe.paginate(f.value),p.value=!1)};return se().onScreenActivated("Artists",async()=>{if(!y.value&&!d){s.value=Ue.artistsViewMode||"thumbnails",d=!0;try{await v()}catch(I){ke.error(I),Xe().toastError("Failed to load artists."),d=!1}}}),(I,m)=>{const k=K("Icon"),D=de("koel-overflow-fade");return t(),o("section",pl,[_(me,{layout:"collapsed"},{controls:h(()=>[_(jt,{modelValue:s.value,"onUpdate:modelValue":m[0]||(m[0]=g=>s.value=g)},null,8,["modelValue"])]),default:h(()=>[C(" Artists ")]),_:1}),y.value?(t(),b(ye,{key:0},{icon:h(()=>[_(k,{icon:e(Ps)},null,8,["icon"])]),default:h(()=>[C(" No artists found. "),u("span",vl,N(e(c)?"Have you set up your library yet?":"Contact your administrator to set up your library."),1)]),_:1})):M((t(),o("div",{key:1,ref_key:"scroller",ref:l,class:z([`as-${s.value}`,"artists main-scroll-wrap"]),"data-testid":"artist-list",onScroll:m[1]||(m[1]=(...g)=>e(r)&&e(r)(...g))},[T.value?(t(),o(E,{key:0},U(10,g=>_(Ie,{key:g,layout:A.value},null,8,["layout"])),64)):(t(),o(E,{key:1},[(t(!0),o(E,null,U(a.value,g=>(t(),b(kt,{key:g.id,artist:g,layout:A.value},null,8,["artist","layout"]))),128)),_(e(n))],64))],34)),[[D]])])}}});const Xt=i=>(Re("data-v-655927bc"),i=i(),Ve(),i),yl=Xt(()=>u("span",{class:"name"},null,-1)),ml=Xt(()=>u("span",{class:"count pulse"},null,-1)),gl=[yl,ml],hl=V({__name:"GenreItemSkeleton",setup(i){const c=Math.random()*100+80;return(s,a)=>(t(),o("article",{class:"skeleton pulse",style:Be({width:`${c}px`})},gl,4))}});const bl=G(hl,[["__scopeId","data-v-655927bc"]]),kl={id:"genresWrapper"},Sl={class:"secondary d-block"},wl={key:1,class:"main-scroll-wrap"},$l={key:0,class:"genres"},Al=["href","title"],xl={class:"name"},Tl={class:"count"},Cl={key:1,class:"genres"},Dl=V({__name:"GenreListScreen",setup(i){const{isAdmin:c}=Ce(),s=x(),a=R(()=>re.state.song_length===0),n=R(()=>ue.exports.maxBy(s.value,"song_count")),l=R(()=>ue.exports.minBy(s.value,"song_count")),r=R(()=>{var A,S;const d=((A=n.value)==null?void 0:A.song_count)||1,p=((S=l.value)==null?void 0:S.song_count)||1,y=(d-p)/5;return[p,p+y,p+y*2,p+y*3,p+y*4,d]}),v=d=>{const p=r.value.findIndex(f=>d.song_count<=f);return p===-1?5:p};return Le(async()=>{a.value||(s.value=await Zs.fetchAll())}),(d,p)=>{const f=K("Icon");return t(),o("section",kl,[_(me,{layout:"collapsed"},{default:h(()=>[C("Genres")]),_:1}),a.value?(t(),b(ye,{key:0},{icon:h(()=>[_(f,{icon:e(It)},null,8,["icon"])]),default:h(()=>[C(" No genres found. "),u("span",Sl,N(e(c)?"Have you set up your library yet?":"Contact your administrator to set up your library."),1)]),_:1})):(t(),o("div",wl,[s.value?(t(),o("ul",$l,[(t(!0),o(E,null,U(s.value,y=>(t(),o("li",{key:y.name,class:z(`level-${v(y)}`)},[u("a",{href:`/#/genres/${encodeURIComponent(y.name)}`,title:`${y.name}: ${e(Se)(y.song_count,"song")}`},[u("span",xl,N(y.name),1),u("span",Tl,N(y.song_count),1)],8,Al)],2))),128))])):(t(),o("ul",Cl,[(t(),o(E,null,U(20,y=>u("li",{key:y},[_(bl)])),64))]))]))])}}});const Pl=G(Dl,[["__scopeId","data-v-e9bebf71"]]),El={id:"songsWrapper"},Il=V({__name:"AllSongsScreen",setup(i){const c=q(re.state,"song_count"),s=R(()=>Es(re.state.song_length)),{SongList:a,SongListControls:n,ControlsToggle:l,ThumbnailStack:r,headerLayout:v,thumbnails:d,songs:p,songList:f,duration:y,showingControls:A,isPhone:S,onPressEnter:T,playSelected:F,onScrollBreakpoint:I}=Je(q(ie.state,"songs")),{toastError:m}=Xe(),{go:k,onScreenActivated:D}=se();let g=!1;const B=x(!1);let w="title",H="asc";const Y=x(1),le=R(()=>Y.value!==null),W=R(()=>B.value&&p.value.length===0),Q=async(ge,De)=>{Y.value=1,ie.state.songs=[],w=ge,H=De,await j()},j=async()=>{if(!(!le.value||B.value)){B.value=!0;try{Y.value=await ie.paginate(w,H,Y.value)}catch(ge){m("Failed to load songs."),ke.error(ge)}finally{B.value=!1}}},we=async ge=>{ge?await ae.fetchRandom():await ae.fetchInOrder(w,H),k("queue"),await oe.playFirstInQueue()};return D("Songs",async()=>{g||(g=!0,await j())}),(ge,De)=>(t(),o("section",El,[_(me,{layout:e(v)},je({thumbnail:h(()=>[_(e(r),{thumbnails:e(d)},null,8,["thumbnails"])]),controls:h(()=>[c.value&&(!e(S)||e(A))?(t(),b(e(n),{key:0,onPlayAll:we,onPlaySelected:e(F)},null,8,["onPlaySelected"])):$("",!0)]),default:h(()=>[C(" All Songs "),_(e(l),{modelValue:e(A),"onUpdate:modelValue":De[0]||(De[0]=Pe=>Me(A)?A.value=Pe:null)},null,8,["modelValue"])]),_:2},[c.value?{name:"meta",fn:h(()=>[u("span",null,N(e(Se)(c.value,"song")),1),u("span",null,N(s.value),1)]),key:"0"}:void 0]),1032,["layout"]),W.value?(t(),b(Ze,{key:0})):(t(),b(e(a),{key:1,ref_key:"songList",ref:f,onSort:Q,onScrollBreakpoint:e(I),"onPress:enter":e(T),onScrolledToEnd:j},null,8,["onScrollBreakpoint","onPress:enter"]))]))}}),Ll={key:0,id:"playlistWrapper"},Rl=["onClick"],Vl=["onClick"],Ol=u("span",{class:"d-block secondary"},' Drag songs into its name in the sidebar or use the "Add To\u2026" button to fill it up. ',-1),Fl=V({__name:"PlaylistScreen",setup(i){const{onRouteChanged:c,triggerNotFound:s,getRouteParam:a,onScreenActivated:n}=se(),l=x(),r=x(),v=x(!1),d={deletePlaylist:!0,refresh:!0},{SongList:p,SongListControls:f,ControlsToggle:y,ThumbnailStack:A,headerLayout:S,songs:T,songList:F,duration:I,thumbnails:m,selectedSongs:k,showingControls:D,isPhone:g,onPressEnter:B,playAll:w,playSelected:H,applyFilter:Y,onScrollBreakpoint:le,sort:W}=Je(x([])),{removeSongsFromPlaylist:Q}=qt(),j=q(re.state,"allow_download"),we=()=>Z.emit("PLAYLIST_DELETE",r.value),ge=()=>ot.fromPlaylist(r.value),De=()=>Z.emit("MODAL_SHOW_EDIT_PLAYLIST_FORM",r.value),Pe=async()=>await Q(r.value,k.value),Ge=async(_e=!1)=>{v.value||(v.value=!0,T.value=await ie.fetchForPlaylist(r.value,_e),v.value=!1,W())};return Te(l,async _e=>{!_e||(r.value=qe.byId(_e),r.value?await Ge():await s())}),n("Playlist",async()=>l.value=parseInt(a("id"))),Z.on("PLAYLIST_UPDATED",async _e=>_e.id===l.value&&await Ge()).on("PLAYLIST_SONGS_REMOVED",async(_e,Ee)=>{_e.id===l.value&&(T.value=ue.exports.differenceBy(T.value,Ee,"id"))}),(_e,Ee)=>{const it=K("Icon");return r.value?(t(),o("section",Ll,[_(me,{layout:e(T).length===0?"collapsed":e(S),disabled:v.value},je({thumbnail:h(()=>[_(e(A),{thumbnails:e(m)},null,8,["thumbnails"])]),controls:h(()=>[!e(g)||e(D)?(t(),b(e(f),{key:0,config:d,onDeletePlaylist:we,onFilter:e(Y),onPlayAll:e(w),onPlaySelected:e(H),onRefresh:Ee[1]||(Ee[1]=$e=>Ge(!0))},null,8,["onFilter","onPlayAll","onPlaySelected"])):$("",!0)]),default:h(()=>[C(N(r.value.name)+" ",1),e(T).length?(t(),b(e(y),{key:0,modelValue:e(D),"onUpdate:modelValue":Ee[0]||(Ee[0]=$e=>Me(D)?D.value=$e:null)},null,8,["modelValue"])):$("",!0)]),_:2},[e(T).length?{name:"meta",fn:h(()=>[u("span",null,N(e(Se)(e(T),"song")),1),u("span",null,N(e(I)),1),j.value?(t(),o("a",{key:0,role:"button",title:"Download all songs in playlist",onClick:L(ge,["prevent"])}," Download All ",8,Rl)):$("",!0)]),key:"0"}:void 0]),1032,["layout","disabled"]),M(_(Ze,null,null,512),[[te,v.value]]),!v.value&&e(T).length?(t(),b(e(p),{key:0,ref_key:"songList",ref:F,onSort:e(W),"onPress:delete":Pe,"onPress:enter":e(B),onScrollBreakpoint:e(le)},null,8,["onSort","onPress:enter","onScrollBreakpoint"])):$("",!0),!e(T).length&&!v.value?(t(),b(ye,{key:1},{icon:h(()=>[_(it,{icon:e(Is)},null,8,["icon"])]),default:h(()=>{var $e;return[($e=r.value)!=null&&$e.is_smart?(t(),o(E,{key:0},[C(" No songs match the playlist's "),u("a",{onClick:L(De,["prevent"])},"criteria",8,Vl),C(". ")],64)):(t(),o(E,{key:1},[C(" The playlist is currently empty. "),Ol],64))]}),_:1})):$("",!0)])):$("",!0)}}}),Ml={id:"favoritesWrapper"},Nl=["onClick"],Bl={class:"secondary d-block"},Ul=V({__name:"FavoritesScreen",setup(i){const{SongList:c,SongListControls:s,ControlsToggle:a,ThumbnailStack:n,headerLayout:l,songs:r,songList:v,duration:d,thumbnails:p,selectedSongs:f,showingControls:y,isPhone:A,onPressEnter:S,playAll:T,playSelected:F,applyFilter:I,onScrollBreakpoint:m,sort:k}=Je(q(We.state,"songs")),D=q(re.state,"allow_download"),g=()=>ot.fromFavorites(),B=()=>f.value.length&&We.unlike(f.value);let w=!1;const H=x(!1),Y=async()=>{H.value=!0,await We.fetch(),H.value=!1,await yt(),k()};return se().onScreenActivated("Favorites",async()=>{w||(w=!0,await Y())}),(le,W)=>{const Q=K("Icon");return t(),o("section",Ml,[_(me,{layout:e(r).length===0?"collapsed":e(l)},je({thumbnail:h(()=>[_(e(n),{thumbnails:e(p)},null,8,["thumbnails"])]),controls:h(()=>[e(r).length&&(!e(A)||e(y))?(t(),b(e(s),{key:0,onFilter:e(I),onPlayAll:e(T),onPlaySelected:e(F)},null,8,["onFilter","onPlayAll","onPlaySelected"])):$("",!0)]),default:h(()=>[C(" Songs You Love "),_(e(a),{modelValue:e(y),"onUpdate:modelValue":W[0]||(W[0]=j=>Me(y)?y.value=j:null)},null,8,["modelValue"])]),_:2},[e(r).length?{name:"meta",fn:h(()=>[u("span",null,N(e(Se)(e(r),"song")),1),u("span",null,N(e(d)),1),D.value?(t(),o("a",{key:0,class:"download",role:"button",title:"Download all songs in playlist",onClick:L(g,["prevent"])}," Download All ",8,Nl)):$("",!0)]),key:"0"}:void 0]),1032,["layout"]),H.value?(t(),b(Ze,{key:0})):$("",!0),e(r).length?(t(),b(e(c),{key:1,ref_key:"songList",ref:v,onSort:e(k),"onPress:delete":B,"onPress:enter":e(S),onScrollBreakpoint:e(m)},null,8,["onSort","onPress:enter","onScrollBreakpoint"])):(t(),b(ye,{key:2},{icon:h(()=>[_(Q,{icon:e(Ls)},null,8,["icon"])]),default:h(()=>[C(" No favorites yet. "),u("span",Bl,[C(" Click the\xA0 "),_(Q,{icon:e(Rs)},null,8,["icon"]),C("\xA0 icon to mark a song as favorite. ")])]),_:1}))])}}}),ql={id:"recentlyPlayedWrapper"},Hl=u("span",{class:"secondary d-block"},"Start playing to populate this playlist.",-1),Ql=V({__name:"RecentlyPlayedScreen",setup(i){const c=q(xt.state,"songs"),{SongList:s,SongListControls:a,ControlsToggle:n,ThumbnailStack:l,headerLayout:r,songs:v,songList:d,thumbnails:p,duration:f,showingControls:y,isPhone:A,onPressEnter:S,playAll:T,playSelected:F,applyFilter:I,onScrollBreakpoint:m}=Je(c);let k=!1,D=x(!1);return se().onScreenActivated("RecentlyPlayed",async()=>{k||(D.value=!0,k=!0,await xt.fetch(),D.value=!1)}),(g,B)=>{const w=K("Icon");return t(),o("section",ql,[_(me,{layout:e(v).length===0?"collapsed":e(r)},je({thumbnail:h(()=>[_(e(l),{thumbnails:e(p)},null,8,["thumbnails"])]),controls:h(()=>[e(v).length&&(!e(A)||e(y))?(t(),b(e(a),{key:0,onFilter:e(I),onPlayAll:e(T),onPlaySelected:e(F)},null,8,["onFilter","onPlayAll","onPlaySelected"])):$("",!0)]),default:h(()=>[C(" Recently Played "),_(e(n),{modelValue:e(y),"onUpdate:modelValue":B[0]||(B[0]=H=>Me(y)?y.value=H:null)},null,8,["modelValue"])]),_:2},[e(v).length?{name:"meta",fn:h(()=>[u("span",null,N(e(Se)(e(v),"song")),1),u("span",null,N(e(f)),1)]),key:"0"}:void 0]),1032,["layout"]),e(D)?(t(),b(Ze,{key:0})):$("",!0),e(v).length?(t(),b(e(s),{key:1,ref_key:"songList",ref:d,"onPress:enter":e(S),onScrollBreakpoint:e(m)},null,8,["onPress:enter","onScrollBreakpoint"])):(t(),b(ye,{key:2},{icon:h(()=>[_(w,{icon:e(Vs)},null,8,["icon"])]),default:h(()=>[C(" No songs recently played. "),Hl]),_:1}))])}}}),Gl={id:"uploadWrapper"},Yl={class:"main-scroll-wrap"},zl=["onDragenter","onDragleave","onDrop"],Kl={key:0,class:"upload-files"},Wl={class:"secondary d-block"},jl={class:"or-click d-block",role:"button"},Xl=["accept"],Jl=V({__name:"UploadScreen",setup(i){const c=X(()=>J(()=>Promise.resolve().then(()=>Ua),void 0)),s=X(()=>J(()=>import("./Btn.abe2bb59.js").then(k=>k.a),["assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/index.8f0bf197.js","assets/_plugin-vue_export-helper.cdc0426e.js"])),a=X(()=>J(()=>import("./UploadItem.4c0e310b.js"),["assets/UploadItem.4c0e310b.js","assets/UploadItem.a7426bcd.css","assets/index.8f0bf197.js","assets/_plugin-vue_export-helper.cdc0426e.js"])),n=js.join(","),{allowsUpload:l,mediaPathSetUp:r,queueFilesForUpload:v,handleDropEvent:d}=Ws(),p=q(dt.state,"files"),f=x(!1),y=R(()=>p.value.filter(k=>k.status==="Errored").length>0),A=()=>f.value=l.value,S=()=>f.value=!1,T=k=>{const D=k.target.files;D!=null&&D.length&&v(Array.from(D))},F=async k=>{f.value=!1,await d(k)},I=()=>dt.retryAll(),m=()=>dt.removeFailed();return(k,D)=>{const g=K("Icon"),B=de("koel-overflow-fade");return t(),o("section",Gl,[_(me,{layout:"collapsed"},{controls:h(()=>[y.value?(t(),b(e(c),{key:0,uppercased:""},{default:h(()=>[_(e(s),{"data-testid":"upload-retry-all-btn",green:"",onClick:I},{default:h(()=>[_(g,{icon:e(Dt)},null,8,["icon"]),C(" Retry All ")]),_:1}),_(e(s),{"data-testid":"upload-remove-all-btn",orange:"",onClick:m},{default:h(()=>[_(g,{icon:e(Pt)},null,8,["icon"]),C(" Remove Failed ")]),_:1})]),_:1})):$("",!0)]),default:h(()=>[C(" Upload Media ")]),_:1}),M((t(),o("div",Yl,[e(r)?(t(),o("div",{key:0,class:z([{droppable:f.value},"upload-panel"]),onDragenter:L(A,["prevent"]),onDragleave:L(S,["prevent"]),onDrop:L(F,["prevent"]),onDragover:D[0]||(D[0]=L(()=>{},["prevent"]))},[p.value.length?(t(),o("div",Kl,[(t(!0),o(E,null,U(p.value,w=>(t(),b(e(a),{key:w.id,file:w,"data-testid":"upload-item"},null,8,["file"]))),128))])):(t(),b(ye,{key:1},{icon:h(()=>[_(g,{icon:e(Lt)},null,8,["icon"])]),default:h(()=>[C(" "+N(e(Ys)?"Drop files or folders to upload":"Drop files to upload")+" ",1),u("span",Wl,[u("a",jl,[C(" or click here to select songs "),u("input",{accept:e(n),multiple:"",name:"file[]",type:"file",onChange:T},null,40,Xl)])])]),_:1}))],42,zl)):(t(),b(ye,{key:1},{icon:h(()=>[_(g,{icon:e(Os)},null,8,["icon"])]),default:h(()=>[C(" No media path set. ")]),_:1}))])),[[B]])])}}});const St=i=>(Re("data-v-78ebe553"),i=i(),Ve(),i),Zl={id:"searchExcerptsWrapper"},er={key:0},tr={class:"text-thin"},sr={key:1},ar={ref:"wrapper",class:"main-scroll-wrap"},or={key:0,class:"results"},nr={class:"songs","data-testid":"song-excerpts"},lr={key:0},rr={key:0},cr={key:1},ir={class:"artists","data-testid":"artist-excerpts"},ur=St(()=>u("h1",null,"Artists",-1)),dr={key:0},_r={key:0},pr={key:1},vr={class:"albums","data-testid":"album-excerpts"},fr=St(()=>u("h1",null,"Albums",-1)),yr={key:0},mr={key:0},gr={key:1},hr=St(()=>u("span",{class:"secondary d-block"},"all in one place.",-1)),br=V({__name:"SearchExcerptsScreen",setup(i){const{go:c}=se(),s=q(Tt.state,"excerpt"),a=x(""),n=x(!1),l=()=>c(`search/songs/?q=${a.value}`),r=async()=>{n.value=!0,await Tt.excerptSearch(a.value),n.value=!1};return Z.on("SEARCH_KEYWORDS_CHANGED",async v=>{a.value=v,await r()}).on("SONGS_DELETED",async v=>{ue.exports.intersectionBy(v,s.value.songs,"id").length!==0&&await r()}),(v,d)=>{const p=K("Icon");return t(),o("section",Zl,[_(me,{layout:"collapsed"},{default:h(()=>[a.value?(t(),o("span",er,[C("Searching for "),u("span",tr,N(a.value),1)])):(t(),o("span",sr,"Search"))]),_:1}),u("div",ar,[a.value?(t(),o("div",or,[u("section",nr,[u("h1",null,[C(" Songs "),s.value.songs.length&&!n.value?(t(),b(ve,{key:0,"data-testid":"view-all-songs-btn",orange:"",rounded:"",small:"",onClick:L(l,["prevent"])},{default:h(()=>[C(" View All ")]),_:1},8,["onClick"])):$("",!0)]),n.value?(t(),o("ul",lr,[(t(),o(E,null,U(6,f=>u("li",{key:f},[_(rt)])),64))])):(t(),o(E,{key:1},[s.value.songs.length?(t(),o("ul",rr,[(t(!0),o(E,null,U(s.value.songs,f=>(t(),o("li",{key:f.id},[_(lt,{song:f},null,8,["song"])]))),128))])):(t(),o("p",cr,"None found."))],64))]),u("section",ir,[ur,n.value?(t(),o("ul",dr,[(t(),o(E,null,U(6,f=>u("li",{key:f},[_(Ie,{layout:"compact"})])),64))])):(t(),o(E,{key:1},[s.value.artists.length?(t(),o("ul",_r,[(t(!0),o(E,null,U(s.value.artists,f=>(t(),o("li",{key:f.id},[_(kt,{artist:f,layout:"compact"},null,8,["artist"])]))),128))])):(t(),o("p",pr,"None found."))],64))]),u("section",vr,[fr,n.value?(t(),o("ul",yr,[(t(),o(E,null,U(6,f=>u("li",{key:f},[_(Ie,{layout:"compact"})])),64))])):(t(),o(E,{key:1},[s.value.albums.length?(t(),o("ul",mr,[(t(!0),o(E,null,U(s.value.albums,f=>(t(),o("li",{key:f.id},[_(ct,{album:f,layout:"compact"},null,8,["album"])]))),128))])):(t(),o("p",gr,"None found."))],64))])])):(t(),b(ye,{key:1},{icon:h(()=>[_(p,{icon:e(pt)},null,8,["icon"])]),default:h(()=>[C(" Find songs, artists, and albums, "),hr]),_:1}))],512)])}}});const kr=G(br,[["__scopeId","data-v-78ebe553"]]),Sr={id:"mainContent"},wr=V({__name:"MainContent",setup(i){const c=X(()=>J(()=>import("./UserListScreen.f4d6a384.js"),["assets/UserListScreen.f4d6a384.js","assets/UserListScreen.c7b5d830.css","assets/index.8f0bf197.js","assets/invitationService.3ec71d57.js","assets/useAuthorization.5beda362.js","assets/app.be92839b.js","assets/app.f853c32d.css","assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/_plugin-vue_export-helper.cdc0426e.js","assets/useSongMenuMethods.5f7dfc3e.js","assets/downloadService.40931a22.js","assets/SoundBars.e7c8d9da.js","assets/useUpload.8e7c76aa.js"])),s=X(()=>J(()=>import("./AlbumArtOverlay.3ff94317.js"),["assets/AlbumArtOverlay.3ff94317.js","assets/AlbumArtOverlay.9187d168.css","assets/index.8f0bf197.js","assets/_plugin-vue_export-helper.cdc0426e.js"])),a=X(()=>J(()=>import("./AlbumScreen.c38275ce.js"),["assets/AlbumScreen.c38275ce.js","assets/AlbumScreen.c0acbc4c.css","assets/index.8f0bf197.js","assets/downloadService.40931a22.js","assets/app.be92839b.js","assets/app.f853c32d.css","assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/_plugin-vue_export-helper.cdc0426e.js","assets/ScreenHeaderSkeleton.a1e2892b.js","assets/ScreenHeaderSkeleton.37a4fe2b.css","assets/ArtistAlbumScreenTabs.b0203fe8.js","assets/ArtistAlbumScreenTabs.109d13f3.css","assets/useAuthorization.5beda362.js","assets/useSongMenuMethods.5f7dfc3e.js","assets/SoundBars.e7c8d9da.js","assets/useUpload.8e7c76aa.js"])),n=X(()=>J(()=>import("./ArtistScreen.750a1e53.js"),["assets/ArtistScreen.750a1e53.js","assets/ArtistScreen.263a5a37.css","assets/index.8f0bf197.js","assets/downloadService.40931a22.js","assets/app.be92839b.js","assets/app.f853c32d.css","assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/_plugin-vue_export-helper.cdc0426e.js","assets/ScreenHeaderSkeleton.a1e2892b.js","assets/ScreenHeaderSkeleton.37a4fe2b.css","assets/ArtistAlbumScreenTabs.b0203fe8.js","assets/ArtistAlbumScreenTabs.109d13f3.css","assets/useAuthorization.5beda362.js","assets/useSongMenuMethods.5f7dfc3e.js","assets/SoundBars.e7c8d9da.js","assets/useUpload.8e7c76aa.js"])),l=X(()=>J(()=>import("./GenreScreen.18c7241f.js"),["assets/GenreScreen.18c7241f.js","assets/index.8f0bf197.js","assets/app.be92839b.js","assets/app.f853c32d.css","assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/_plugin-vue_export-helper.cdc0426e.js","assets/ScreenHeaderSkeleton.a1e2892b.js","assets/ScreenHeaderSkeleton.37a4fe2b.css","assets/useAuthorization.5beda362.js","assets/useSongMenuMethods.5f7dfc3e.js","assets/downloadService.40931a22.js","assets/SoundBars.e7c8d9da.js","assets/useUpload.8e7c76aa.js"])),r=X(()=>J(()=>import("./SettingsScreen.7b7ad1cc.js"),["assets/SettingsScreen.7b7ad1cc.js","assets/SettingsScreen.66815e26.css","assets/index.8f0bf197.js","assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/_plugin-vue_export-helper.cdc0426e.js","assets/app.be92839b.js","assets/app.f853c32d.css","assets/useOverlay.b8f8c136.js","assets/useAuthorization.5beda362.js","assets/useSongMenuMethods.5f7dfc3e.js","assets/downloadService.40931a22.js","assets/SoundBars.e7c8d9da.js","assets/useUpload.8e7c76aa.js"])),v=X(()=>J(()=>import("./ProfileScreen.a5649900.js"),["assets/ProfileScreen.a5649900.js","assets/ProfileScreen.2d51f6ce.css","assets/index.8f0bf197.js","assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/_plugin-vue_export-helper.cdc0426e.js","assets/app.be92839b.js","assets/app.f853c32d.css","assets/PasswordField.1e406e0f.js","assets/PasswordField.51a1cd8b.css","assets/useAuthorization.5beda362.js","assets/CheckBox.c099da78.js","assets/CheckBox.24b4716e.css","assets/useSongMenuMethods.5f7dfc3e.js","assets/downloadService.40931a22.js","assets/SoundBars.e7c8d9da.js","assets/useUpload.8e7c76aa.js"])),d=X(()=>J(()=>import("./YouTubeScreen.3edd1986.js"),["assets/YouTubeScreen.3edd1986.js","assets/YouTubeScreen.11adbd17.css","assets/index.8f0bf197.js","assets/app.be92839b.js","assets/app.f853c32d.css","assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/_plugin-vue_export-helper.cdc0426e.js","assets/useAuthorization.5beda362.js","assets/useSongMenuMethods.5f7dfc3e.js","assets/downloadService.40931a22.js","assets/SoundBars.e7c8d9da.js","assets/useUpload.8e7c76aa.js"])),p=X(()=>J(()=>import("./SearchSongResultsScreen.63eb9c8c.js"),["assets/SearchSongResultsScreen.63eb9c8c.js","assets/index.8f0bf197.js","assets/app.be92839b.js","assets/app.f853c32d.css","assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/_plugin-vue_export-helper.cdc0426e.js","assets/useAuthorization.5beda362.js","assets/useSongMenuMethods.5f7dfc3e.js","assets/downloadService.40931a22.js","assets/SoundBars.e7c8d9da.js","assets/useUpload.8e7c76aa.js"])),f=X(()=>J(()=>import("./NotFoundScreen.491ac683.js"),["assets/NotFoundScreen.491ac683.js","assets/index.8f0bf197.js","assets/useAuthorization.5beda362.js","assets/app.be92839b.js","assets/app.f853c32d.css","assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/_plugin-vue_export-helper.cdc0426e.js","assets/useSongMenuMethods.5f7dfc3e.js","assets/downloadService.40931a22.js","assets/SoundBars.e7c8d9da.js","assets/useUpload.8e7c76aa.js"])),y=X(()=>J(()=>import("./VisualizerScreen.62986884.js"),["assets/VisualizerScreen.62986884.js","assets/VisualizerScreen.f8497dd2.css","assets/index.8f0bf197.js"])),{useYouTube:A}=bt(),{onRouteChanged:S,getCurrentScreen:T}=se(),F=be(Ut,x(void 0)),I=q(Ue.state,"showAlbumArtOverlay"),m=x("Home");return S(k=>m.value=k.screen),Le(async()=>{m.value=T()}),(k,D)=>{var g;return t(),o("section",Sr,[m.value==="Visualizer"?(t(),b(e(y),{key:0})):$("",!0),I.value&&e(F)?(t(),b(e(s),{key:1,album:(g=e(F))==null?void 0:g.album_id},null,8,["album"])):$("",!0),M(_(Wn,null,null,512),[[te,m.value==="Home"]]),M(_(nl,null,null,512),[[te,m.value==="Queue"]]),M(_(Il,null,null,512),[[te,m.value==="Songs"]]),M(_(_l,null,null,512),[[te,m.value==="Albums"]]),M(_(fl,null,null,512),[[te,m.value==="Artists"]]),M(_(Fl,null,null,512),[[te,m.value==="Playlist"]]),M(_(Ul,null,null,512),[[te,m.value==="Favorites"]]),M(_(Ql,null,null,512),[[te,m.value==="RecentlyPlayed"]]),M(_(Jl,null,null,512),[[te,m.value==="Upload"]]),M(_(kr,null,null,512),[[te,m.value==="Search.Excerpt"]]),M(_(e(l),null,null,512),[[te,m.value==="Genre"]]),m.value==="Genres"?(t(),b(Pl,{key:2})):$("",!0),m.value==="Search.Songs"?(t(),b(e(p),{key:3})):$("",!0),m.value==="Album"?(t(),b(e(a),{key:4})):$("",!0),m.value==="Artist"?(t(),b(e(n),{key:5})):$("",!0),m.value==="Settings"?(t(),b(e(r),{key:6})):$("",!0),m.value==="Profile"?(t(),b(e(v),{key:7})):$("",!0),m.value==="Users"?(t(),b(e(c),{key:8})):$("",!0),e(A)?M((t(),b(e(d),{key:9},null,512)),[[te,m.value==="YouTube"]]):$("",!0),m.value==="404"?(t(),b(e(f),{key:10})):$("",!0)])}}});const $r={key:0,class:"view-profile","data-testid":"view-profile-link",href:"/#/profile",title:"Profile and preferences"},Ar=["alt","src"],xr=V({__name:"ProfileAvatar",setup(i){const{currentUser:c}=Ce();return(s,a)=>{const n=de("koel-tooltip");return e(c)?M((t(),o("a",$r,[u("img",{alt:`Avatar of ${e(c).name}`,src:e(c).avatar},null,8,Ar)])),[[n,void 0,void 0,{left:!0}]]):$("",!0)}}});const Tr=G(xr,[["__scopeId","data-v-45095b3c"]]),Cr=["onClick"],Dr=V({__name:"SidebarMenuToggleButton",setup(i){const c=()=>Z.emit("TOGGLE_SIDEBAR");return(s,a)=>{const n=K("Icon");return t(),o("button",{onClick:L(c,["prevent","stop"])},[_(n,{icon:e(Fs)},null,8,["icon"])],8,Cr)}}}),Pr={class:"controls"},Er={class:"top"},Ir={class:"bottom"},Lr=["title","onClick"],Rr={key:0,class:"new-version-notification"},Vr=["onClick"],Or={key:0,class:"panes"},Fr={id:"extraPanelLyrics","aria-labelledby":"extraTabLyrics",role:"tabpanel",tabindex:"0"},Mr={id:"extraPanelArtist","aria-labelledby":"extraTabArtist",role:"tabpanel",tabindex:"0"},Nr={key:1},Br={id:"extraPanelAlbum","aria-labelledby":"extraTabAlbum",role:"tabpanel",tabindex:"0"},Ur={key:1},qr={id:"extraPanelYouTube","data-testid":"extra-drawer-youtube","aria-labelledby":"extraTabYouTube",role:"tabpanel",tabindex:"0"},Hr=V({__name:"ExtraDrawer",setup(i){const c=X(()=>J(()=>import("./LyricsPane.a807ecda.js"),["assets/LyricsPane.a807ecda.js","assets/LyricsPane.0526127e.css","assets/index.8f0bf197.js","assets/useAuthorization.5beda362.js","assets/app.be92839b.js","assets/app.f853c32d.css","assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/_plugin-vue_export-helper.cdc0426e.js"])),s=X(()=>J(()=>import("./ArtistInfo.6b4834e4.js"),["assets/ArtistInfo.6b4834e4.js","assets/ArtistInfo.bd5a90e2.css","assets/index.8f0bf197.js","assets/app.be92839b.js","assets/app.f853c32d.css","assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/_plugin-vue_export-helper.cdc0426e.js","assets/mediaInfoService.83930c31.js","assets/useAuthorization.5beda362.js","assets/useSongMenuMethods.5f7dfc3e.js","assets/downloadService.40931a22.js","assets/SoundBars.e7c8d9da.js","assets/useUpload.8e7c76aa.js"])),a=X(()=>J(()=>import("./AlbumInfo.26b205e3.js"),["assets/AlbumInfo.26b205e3.js","assets/AlbumInfo.51727455.css","assets/index.8f0bf197.js","assets/app.be92839b.js","assets/app.f853c32d.css","assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/_plugin-vue_export-helper.cdc0426e.js","assets/mediaInfoService.83930c31.js","assets/useAuthorization.5beda362.js","assets/useSongMenuMethods.5f7dfc3e.js","assets/downloadService.40931a22.js","assets/SoundBars.e7c8d9da.js","assets/useUpload.8e7c76aa.js"])),n=X(()=>J(()=>import("./YouTubeVideoList.3d9b2478.js").then(I=>I.Y),["assets/YouTubeVideoList.3d9b2478.js","assets/YouTubeVideoList.0280e939.css","assets/index.8f0bf197.js","assets/_plugin-vue_export-helper.cdc0426e.js"])),l=X(()=>J(()=>import("./ExtraDrawerTabHeader.9aabbe75.js"),["assets/ExtraDrawerTabHeader.9aabbe75.js","assets/index.8f0bf197.js","assets/app.be92839b.js","assets/app.f853c32d.css","assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/_plugin-vue_export-helper.cdc0426e.js","assets/useAuthorization.5beda362.js","assets/useSongMenuMethods.5f7dfc3e.js","assets/downloadService.40931a22.js","assets/SoundBars.e7c8d9da.js","assets/useUpload.8e7c76aa.js"]));Ce();const{useYouTube:r}=bt(),{shouldNotifyNewVersion:v}=oa(),d=be(Ut,x(void 0)),p=x(null),f=x(),y=x(),A=async I=>{d.value=I,f.value=void 0,y.value=void 0;try{f.value=await Fe.resolve(I.artist_id),y.value=await He.resolve(I.album_id)}catch(m){ke.log("Failed to fetch media information",m)}};Te(d,I=>I&&A(I),{immediate:!0}),Te(p,I=>Ue.activeExtraPanelTab=I);const S=()=>Z.emit("MODAL_SHOW_ABOUT_KOEL"),T=()=>Ne.any&&(p.value=null),F=()=>Z.emit("LOG_OUT");return Le(()=>Ne.any||(p.value=Ue.activeExtraPanelTab)),(I,m)=>{const k=K("Icon"),D=de("koel-tooltip");return t(),o("aside",{class:z({"showing-pane":p.value})},[u("div",Pr,[u("div",Er,[_(Dr,{class:"burger"}),e(d)?(t(),b(e(l),{key:0,modelValue:p.value,"onUpdate:modelValue":m[0]||(m[0]=g=>p.value=g)},null,8,["modelValue"])):$("",!0)]),u("div",Ir,[M((t(),o("button",{title:e(v)?"New version available!":"About Koel",type:"button",onClick:L(S,["prevent"])},[_(k,{icon:e(Ms)},null,8,["icon"]),e(v)?(t(),o("span",Rr)):$("",!0)],8,Lr)),[[D,void 0,void 0,{left:!0}]]),M((t(),o("button",{title:"Log out",type:"button",onClick:L(F,["prevent"])},[_(k,{icon:e(Ns)},null,8,["icon"])],8,Vr)),[[D,void 0,void 0,{left:!0}]]),_(Tr,{onClick:T})])]),e(d)?M((t(),o("div",Or,[M(u("div",Fr,[_(e(c),{song:e(d)},null,8,["song"])],512),[[te,p.value==="Lyrics"]]),M(u("div",Mr,[f.value?(t(),b(e(s),{key:0,artist:f.value,mode:"aside"},null,8,["artist"])):(t(),o("span",Nr,"Loading\u2026"))],512),[[te,p.value==="Artist"]]),M(u("div",Br,[y.value?(t(),b(e(a),{key:0,album:y.value,mode:"aside"},null,8,["album"])):(t(),o("span",Ur,"Loading\u2026"))],512),[[te,p.value==="Album"]]),M(u("div",qr,[e(r)&&e(d)?(t(),b(e(n),{key:0,song:e(d)},null,8,["song"])):$("",!0)],512),[[te,p.value==="YouTube"]])],512)),[[te,p.value]]):$("",!0)],2)}}});const Qr=G(Hr,[["__scopeId","data-v-3d44a42f"]]),Gr={id:"mainWrapper"},Yr=V({__name:"index",setup(i){const c=X(()=>J(()=>import("./ModalWrapper.ae0d5878.js"),["assets/ModalWrapper.ae0d5878.js","assets/ModalWrapper.a502f15f.css","assets/index.8f0bf197.js","assets/app.be92839b.js","assets/app.f853c32d.css","assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/_plugin-vue_export-helper.cdc0426e.js"]));return(s,a)=>(t(),o("div",Gr,[_(wo),_(wr),_(Qr),_(e(c))]))}});const nc=Object.freeze(Object.defineProperty({__proto__:null,default:Yr},Symbol.toStringTag,{value:"Module"}));export{Xo as A,Ua as B,ia as C,me as S,ct as _,Ze as a,bt as b,ye as c,sc as d,Xa as e,ac as f,Zs as g,oa as h,oc as i,nc as j,Je as u};
