import{v as b,j as u,w as I,z as B,A as S,G as a,R as r,aa as U,aH as D,P as m,O as v,F as _,aG as O,bx as A,a5 as F,a6 as T}from"./index.8f0bf197.js";import{i as K}from"./invitationService.3ec71d57.js";import{k as M,l as N}from"./app.be92839b.js";import{u as G}from"./useOverlay.b8f8c136.js";import{B as f}from"./Btn.abe2bb59.js";import{_ as P}from"./TooltipIcon.vue_vue_type_script_setup_true_lang.7d6ec67c.js";import{C as $}from"./CheckBox.c099da78.js";import{_ as j}from"./_plugin-vue_export-helper.cdc0426e.js";const h=i=>(F("data-v-200995d0"),i=i(),T(),i),q=["onSubmit","onKeydown"],z=h(()=>a("header",null,[a("h1",null,"Invite Users")],-1)),H={class:"form-row"},R=h(()=>a("small",{class:"help"},"To invite multiple users, input one email per line.",-1)),J={class:"form-row"},L=b({__name:"InviteUserForm",emits:["close"],setup(i,{emit:y}){const{showOverlay:w,hideOverlay:g}=G(),{toastSuccess:E}=M(),{showErrorDialog:V,showConfirmDialog:k}=N(),l=u(),d=u(""),n=u(!1);let o=[];I(d,s=>{o=s.trim().split(`
`).map(e=>e.trim()).filter(Boolean),o=[...new Set(o)]});const x=async()=>{const s=[],e=document.createElement("input");if(e.type="email",o.forEach(t=>{e.value=t,e.checkValidity()&&s.push(t)}),s.length!==o.length){l.value.setCustomValidity("One or some of the emails you entered are invalid."),l.value.reportValidity();return}if(s.length===0){l.value.setCustomValidity("Please enter at least one email address."),l.value.reportValidity();return}w();try{await K.invite(s,n.value),E(`Invitation${s.length===1?"":"s"} sent.`),c()}catch(t){const C=t.response.status===422?A(t.response.data)[0]:"Unknown error.";V(C,"Error")}finally{g()}},c=()=>y("close"),p=async()=>{if(o.length===0&&!n.value){c();return}await k("Discard all changes?")&&c()};return(s,e)=>(B(),S("form",{novalidate:"",onSubmit:_(x,["prevent"]),onKeydown:O(p,["esc"])},[z,a("main",null,[a("div",H,[a("label",null,[r(" Emails "),R,U(a("textarea",{ref_key:"emailsEl",ref:l,"onUpdate:modelValue":e[0]||(e[0]=t=>d.value=t),name:"emails",required:"",title:"Emails"},null,512),[[D,d.value]])])]),a("div",J,[a("label",null,[m($,{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=t=>n.value=t),name:"is_admin"},null,8,["modelValue"]),r(" Admin role "),m(P,{title:"Admins can perform administrative tasks like managing users and uploading songs."})])])]),a("footer",null,[m(f,{class:"btn-add",type:"submit"},{default:v(()=>[r("Invite")]),_:1}),m(f,{class:"btn-cancel",white:"",onClick:_(p,["prevent"])},{default:v(()=>[r("Cancel")]),_:1},8,["onClick"])])],40,q))}});const se=j(L,[["__scopeId","data-v-200995d0"]]);export{se as default};
