import{v as $,x as T,n as R,y as x,z as s,A as o,G as a,B as t,N as w,C as d,T as F,I as p,bA as P,O as i,R as m,Z as I,Q as N,k as E,u as A,bx as H,$ as B,a0 as b,aj as W,i as j,j as z,V as G,a9 as Y,P as c,aa as Q,Y as O,a5 as Z,a6 as q,bB as J}from"./index.8f0bf197.js";import{S as K,C as X}from"./index.f07e8060.js";import{i as ee}from"./invitationService.3ec71d57.js";import{u as se}from"./useAuthorization.5beda362.js";import{k as te,l as oe,j as ae}from"./app.be92839b.js";import{B as D}from"./Btn.abe2bb59.js";import{_ as M}from"./_plugin-vue_export-helper.cdc0426e.js";import"./useSongMenuMethods.5f7dfc3e.js";import"./downloadService.40931a22.js";import"./SoundBars.e7c8d9da.js";import"./useUpload.8e7c76aa.js";const ne=["alt","src"],re={key:0,class:"name"},ie={key:1,class:"name anonymous"},le={class:"email text-secondary"},ce=$({__name:"UserCard",props:{user:{}},setup(u){const k=u,{user:e}=T(k),{toastSuccess:v}=te(),{showConfirmDialog:y,showErrorDialog:f}=oe(),{go:U}=ae(),{currentUser:h}=se(),l=R(()=>e.value.id===h.value.id),S=()=>l.value?U("profile"):E.emit("MODAL_SHOW_EDIT_USER_FORM",e.value),n=async()=>{!await y(`Unperson ${e.value.name}?`)||(await A.destroy(e.value),v(`User "${e.value.name}" deleted.`))},g=async()=>{if(!!await y(`Revoke the invite for ${e.value.email}?`))try{await ee.revoke(e.value),v(`Invitation for ${e.value.email} revoked.`)}catch(_){if(_.response.status===404){f("Cannot revoke the invite. Maybe it has been accepted?","Revocation Failed");return}const C=_.response.status===422?H(_.response.data)[0]:"Unknown error.";f(C,"Error")}};return(_,C)=>{const r=x("Icon"),L=x("icon");return s(),o("article",{class:N([{me:l.value},"user-card"])},[a("img",{alt:`${t(e).name}'s avatar`,src:t(e).avatar,height:"80",width:"80"},null,8,ne),a("main",null,[a("h1",null,[t(e).name?(s(),o("span",re,w(t(e).name),1)):(s(),o("span",ie,"Anonymous")),l.value?(s(),d(r,{key:2,icon:t(F),class:"you text-highlight",title:"This is you!"},null,8,["icon"])):p("",!0),t(e).is_admin?(s(),d(L,{key:3,icon:t(P),class:"is-admin text-blue",title:"User has admin privileges"},null,8,["icon"])):p("",!0)]),a("p",le,w(t(e).email),1),a("footer",null,[t(e).is_prospect?(s(),d(D,{key:0,class:"btn-revoke",red:"",small:"",onClick:g},{default:i(()=>[m("Revoke")]),_:1})):(s(),o(I,{key:1},[l.value?p("",!0):(s(),d(D,{key:0,class:"btn-delete",red:"",small:"",onClick:n},{default:i(()=>[m("Delete")]),_:1})),t(e).is_prospect?p("",!0):(s(),d(D,{key:1,class:"btn-edit",orange:"",small:"",onClick:S},{default:i(()=>[m(w(l.value?"Your Profile":"Edit"),1)]),_:1}))],64))])])],2)}}});const V=M(ce,[["__scopeId","data-v-5ca8d9dc"]]),ue=u=>(Z("data-v-d1217f00"),u=u(),q(),u),_e={id:"usersWrapper"},de={class:"main-scroll-wrap"},pe={class:"users"},me=ue(()=>a("h2",{class:"invited-heading","data-testid":"prospects-heading"},[a("i"),a("span",null,"Invited"),a("i")],-1)),ve={class:"users"},fe=$({__name:"UserListScreen",setup(u){const k=B(()=>b(()=>import("./Btn.abe2bb59.js").then(n=>n.a),["assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/index.8f0bf197.js","assets/_plugin-vue_export-helper.cdc0426e.js"])),e=B(()=>b(()=>import("./index.f07e8060.js").then(n=>n.B),["assets/index.f07e8060.js","assets/index.5481f61c.css","assets/index.8f0bf197.js","assets/useAuthorization.5beda362.js","assets/app.be92839b.js","assets/app.f853c32d.css","assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/_plugin-vue_export-helper.cdc0426e.js","assets/useSongMenuMethods.5f7dfc3e.js","assets/downloadService.40931a22.js","assets/SoundBars.e7c8d9da.js","assets/useUpload.8e7c76aa.js"])),v=W(A.state,"users"),y=R(()=>v.value.filter(n=>!n.is_prospect)),f=R(()=>v.value.filter(n=>n.is_prospect)),U=j.phone,h=z(!1),l=()=>E.emit("MODAL_SHOW_ADD_USER_FORM"),S=()=>E.emit("MODAL_SHOW_INVITE_USER_FORM");return G(async()=>await A.fetch()),(n,g)=>{const _=x("Icon"),C=Y("koel-overflow-fade");return s(),o("section",_e,[c(K,{layout:"collapsed"},{controls:i(()=>[h.value||!t(U)?(s(),d(t(e),{key:0,uppercased:""},{default:i(()=>[c(t(k),{class:"btn-add",green:"",onClick:l},{default:i(()=>[c(_,{icon:t(J)},null,8,["icon"]),m(" Add ")]),_:1}),c(t(k),{class:"btn-invite",orange:"",onClick:S},{default:i(()=>[m("Invite")]),_:1})]),_:1})):p("",!0)]),default:i(()=>[m(" Users "),c(X,{modelValue:h.value,"onUpdate:modelValue":g[0]||(g[0]=r=>h.value=r)},null,8,["modelValue"])]),_:1}),Q((s(),o("div",de,[a("ul",pe,[(s(!0),o(I,null,O(y.value,r=>(s(),o("li",{key:r.id},[c(V,{user:r},null,8,["user"])]))),128))]),f.value.length?(s(),o(I,{key:0},[me,a("ul",ve,[(s(!0),o(I,null,O(f.value,r=>(s(),o("li",{key:r.id},[c(V,{user:r},null,8,["user"])]))),128))])],64)):p("",!0)])),[[C]])])}}});const xe=M(fe,[["__scopeId","data-v-d1217f00"]]);export{xe as default};
