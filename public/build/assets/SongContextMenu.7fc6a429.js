import{v as ae,j as le,aj as y,at as g,c as ne,q as _,n as m,k as S,d as ie,a9 as re,z as t,C as ue,O as ce,B as n,A as a,G as s,F as de,Z as c,I as r,R as me,aa as ve,Y as pe,N as ye,g as _e,s as N,aM as ke,a5 as fe,a6 as ge}from"./index.8f0bf197.js";import{c as Se}from"./Btn.abe2bb59.js";import{d as Ce}from"./downloadService.40931a22.js";import{k as he,l as we,j as be,p as C}from"./app.be92839b.js";import{u as Fe}from"./useAuthorization.5beda362.js";import{u as Pe}from"./useContextMenu.bb260cc5.js";import{a as Te,u as De}from"./useSongMenuMethods.5f7dfc3e.js";import{_ as xe}from"./_plugin-vue_export-helper.cdc0426e.js";const d=v=>(fe("data-v-8ee53164"),v=v(),ge(),v),Me=["onClick"],Ee={key:0},Ne={key:1},Re={class:"has-sub"},Ae={class:"menu submenu menu-add-to"},Be=d(()=>s("li",{class:"separator"},null,-1)),Ie={key:3,class:"separator"},Oe={key:4,class:"playlists"},Qe=["onClick"],qe=d(()=>s("li",{class:"separator"},null,-1)),Ge=d(()=>s("li",{class:"separator"},null,-1)),Ue=d(()=>s("li",{class:"separator"},null,-1)),$e=d(()=>s("li",{class:"separator"},null,-1)),Le=d(()=>s("li",{class:"separator"},null,-1)),je=d(()=>s("li",{class:"separator"},null,-1)),ze=d(()=>s("li",{class:"separator"},null,-1)),Ve=ae({__name:"SongContextMenu",setup(v){const{toastSuccess:h}=he(),{showConfirmDialog:R}=we(),{go:w,getRouteParam:b,isCurrentScreen:k}=be(),{isAdmin:F}=Fe(),{base:A,ContextMenuBase:B,open:I,close:O,trigger:u}=Pe(),{removeSongsFromPlaylist:Q}=Te(),e=le([]),{queueSongsAfterCurrent:P,queueSongsToBottom:p,queueSongsToTop:T,addSongsToFavorite:D,addSongsToExistingPlaylist:q,addSongsToNewPlaylist:x}=De(e,O),G=y(g.state,"playlists"),U=y(ne.state,"allow_download"),$=y(_.state,"songs"),L=y(_,"current"),M=m(()=>e.value.length===1),j=m(()=>e.value.length?e.value[0].playback_state==="Playing":!1),f=m(()=>G.value.filter(i=>!i.is_smart)),z=m(()=>{if(!k("Playlist"))return!1;const i=g.byId(parseInt(b("id")));return i&&!i.is_smart}),V=m(()=>k("Queue")),E=m(()=>k("Favorites")),X=()=>u(()=>{if(!!e.value.length)switch(e.value[0].playback_state){case"Playing":C.pause();break;case"Paused":C.resume();break;default:_.queueIfNotQueued(e.value[0]),C.play(e.value[0]);break}}),Y=()=>u(()=>e.value.length&&S.emit("MODAL_SHOW_EDIT_SONG_FORM",e.value)),H=i=>u(()=>w(`album/${i}`)),W=i=>u(()=>w(`artist/${i}`)),Z=()=>u(()=>Ce.fromSongs(e.value)),J=()=>u(async()=>{const i=g.byId(parseInt(b("id")));!i||await Q(i,e.value)}),K=()=>u(()=>_.unqueue(e.value)),ee=()=>u(()=>_e.unlike(e.value)),se=()=>u(()=>{Se(N.getShareableUrl(e.value[0])),h("URL copied to clipboard.")}),te=()=>u(async()=>{await R("Delete selected song(s) from the filesystem? This action is NOT reversible!")&&(await N.deleteFromFilesystem(e.value),h(`Deleted ${ke(e.value,"song")} from the filesystem.`),S.emit("SONGS_DELETED",e.value))});return S.on("SONG_CONTEXT_MENU_REQUESTED",async(i,o)=>{e.value=ie(o),await I(i.pageY,i.pageX)}),(i,o)=>{const oe=re("koel-overflow-fade");return t(),ue(n(B),{ref_key:"base",ref:A,"data-testid":"song-context-menu","extra-class":"song-menu"},{default:ce(()=>[M.value?(t(),a(c,{key:0},[s("li",{onClick:de(X,["stop","prevent"])},[j.value?(t(),a("span",Ee,"Pause")):(t(),a("span",Ne,"Play"))],8,Me),s("li",{onClick:o[0]||(o[0]=l=>H(e.value[0].album_id))},"Go to Album"),s("li",{onClick:o[1]||(o[1]=l=>W(e.value[0].artist_id))},"Go to Artist")],64)):r("",!0),s("li",Re,[me(" Add To "),s("ul",Ae,[$.value.length?(t(),a(c,{key:0},[L.value?(t(),a("li",{key:0,onClick:o[2]||(o[2]=(...l)=>n(P)&&n(P)(...l))},"After Current Song")):r("",!0),s("li",{onClick:o[3]||(o[3]=(...l)=>n(p)&&n(p)(...l))},"Bottom of Queue"),s("li",{onClick:o[4]||(o[4]=(...l)=>n(T)&&n(T)(...l))},"Top of Queue")],64)):(t(),a("li",{key:1,onClick:o[5]||(o[5]=(...l)=>n(p)&&n(p)(...l))},"Queue")),E.value?r("",!0):(t(),a(c,{key:2},[Be,s("li",{onClick:o[6]||(o[6]=(...l)=>n(D)&&n(D)(...l))},"Favorites")],64)),f.value.length?(t(),a("li",Ie)):r("",!0),f.value.length?ve((t(),a("ul",Oe,[(t(!0),a(c,null,pe(f.value,l=>(t(),a("li",{key:l.id,onClick:Xe=>n(q)(l)},ye(l.name),9,Qe))),128))])),[[oe]]):r("",!0),qe,s("li",{onClick:o[7]||(o[7]=(...l)=>n(x)&&n(x)(...l))},"New Playlist\u2026")])]),V.value?(t(),a(c,{key:1},[Ge,s("li",{onClick:K},"Remove from Queue"),Ue],64)):r("",!0),E.value?(t(),a(c,{key:2},[$e,s("li",{onClick:ee},"Remove from Favorites"),Le],64)):r("",!0),n(F)?(t(),a("li",{key:3,onClick:Y},"Edit\u2026")):r("",!0),U.value?(t(),a("li",{key:4,onClick:Z},"Download")):r("",!0),M.value?(t(),a("li",{key:5,onClick:se},"Copy Shareable URL")):r("",!0),z.value?(t(),a(c,{key:6},[je,s("li",{onClick:J},"Remove from Playlist")],64)):r("",!0),n(F)?(t(),a(c,{key:7},[ze,s("li",{onClick:te},"Delete from Filesystem")],64)):r("",!0)]),_:1},512)}}});const ts=xe(Ve,[["__scopeId","data-v-8ee53164"]]);export{ts as default};
