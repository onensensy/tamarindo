import{v as X,$ as A,j as n,aj as q,e as Q,w as O,n as b,V as Z,av as J,y as W,a9 as ee,A as i,Z as P,C as ae,B as s,I as te,G as a,a7 as oe,N as f,Q as V,F as v,P as d,aa as se,ab as le,R as ne,a0 as x,as as ie,a as r,u as L,l as ce,z as l,a8 as re,D as ue,E as de,ap as ve,an as _e,ao as pe,aq as me,ac as ye,ae as ke,ay as he,az as Se,aA as fe}from"./index.8f0bf197.js";import{n as ge}from"./nouislider.56dafe2f.js";const we={key:0,class:"details"},Ee={class:"info"},Ce={class:"wrap"},Te={class:"title text"},Ae={class:"artist text"},Oe={class:"album text"},be={key:1,class:"none text-secondary"},Pe=["onClick"],Ve=["onClick"],xe=["onClick"],Le={class:"volume"},Ke=["onClick"],Ue={key:1,class:"loader"},Ie={key:0},Ne=a("p",null,"Searching for Koel\u2026",-1),Re=a("div",{class:"signal"},null,-1),Be=[Ne,Re],De={key:1},Fe=["onClick"],Me={key:1,class:"login-wrapper"},Ge=10,h=7,ze=X({__name:"App",setup(He){const K=A(()=>x(()=>import("./AlbumArtOverlay.3ff94317.js"),["assets/AlbumArtOverlay.3ff94317.js","assets/AlbumArtOverlay.9187d168.css","assets/index.8f0bf197.js","assets/_plugin-vue_export-helper.cdc0426e.js"])),U=A(()=>x(()=>import("./LoginForm.12838887.js"),["assets/LoginForm.12838887.js","assets/LoginForm.755cf9db.css","assets/index.8f0bf197.js","assets/logo.cf71f526.js","assets/Btn.abe2bb59.js","assets/Btn.535c40ae.css","assets/_plugin-vue_export-helper.cdc0426e.js","assets/PasswordField.1e406e0f.js","assets/PasswordField.51a1cd8b.css"])),u=n(),_=n(!1),e=n(),p=n(!1),g=n(!1),m=n(!1),y=n(0),I=q(Q.state,"showAlbumArtOverlay"),k=n(h),N=n(window.navigator.standalone||window.matchMedia("(display-mode: standalone)").matches);O(p,async()=>{if(await ie(),!!u.value){if(ge.create(u.value,{orientation:"vertical",connect:[!0,!1],start:k.value||h,range:{min:0,max:10},direction:"rtl"}),!u.value.noUiSlider)throw new Error("Failed to initialize noUISlider on element #volumeSlider");u.value.noUiSlider.on("change",(t,c)=>{const o=t[c];g.value=!o,r.broadcast("SOCKET_SET_VOLUME",o)})}}),O(k,()=>{var t,c;return(c=u.value)==null?void 0:c.noUiSlider.set((t=k.value)!=null?t:h)});const R=async()=>{_.value=!0,await w()},w=async()=>{try{L.init(await L.getProfile()),await r.init(),r.listen("SOCKET_SONG",t=>e.value=t).listen("SOCKET_PLAYBACK_STOPPED",()=>e.value&&(e.value.playback_state="Stopped")).listen("SOCKET_VOLUME_CHANGED",t=>{var c,o;return(o=(c=u.value)==null?void 0:c.noUiSlider)==null?void 0:o.set(t)}).listen("SOCKET_STATUS",t=>{e.value=t.song,k.value=t.volume||h,p.value=!0}),S()}catch(t){ce.error(t),_.value=!1}},B=()=>m.value=!m.value,D=()=>m.value=!1,F=()=>{!e.value||(e.value.liked=!e.value.liked,r.broadcast("SOCKET_TOGGLE_FAVORITE"))},M=()=>{e.value&&(e.value.playback_state=e.value.playback_state==="Playing"?"Paused":"Playing"),r.broadcast("SOCKET_TOGGLE_PLAYBACK")},G=()=>r.broadcast("SOCKET_PLAY_NEXT"),z=()=>r.broadcast("SOCKET_PLAY_PREV"),H=()=>r.broadcast("SOCKET_GET_STATUS"),S=()=>{p.value?y.value=0:E.value||(H(),y.value++,window.setTimeout(S,1e3))},Y=()=>{y.value=0,S()},$=b(()=>{var t;return Boolean(((t=e.value)==null?void 0:t.playback_state)==="Playing")}),E=b(()=>y.value>=Ge);return Z(async()=>{J.hasApiToken()&&(_.value=!0,await w())}),(t,c)=>{var C,T;const o=W("Icon"),j=ee("koel-clickaway");return l(),i("div",{id:"wrapper",class:V({standalone:N.value})},[_.value?(l(),i(P,{key:0},[I.value&&e.value?(l(),ae(s(K),{key:0,album:e.value.album_id},null,8,["album"])):te("",!0),a("main",null,[p.value?(l(),i(P,{key:0},[e.value?(l(),i("div",we,[a("div",{style:oe({backgroundImage:`url(${e.value.album_cover||s(re)})`}),class:"cover"},null,4),a("div",Ee,[a("div",Ce,[a("p",Te,f(e.value.title),1),a("p",Ae,f(e.value.artist_name),1),a("p",Oe,f(e.value.album_name),1)])])])):(l(),i("p",be,"No song is playing.")),a("footer",null,[a("a",{class:V(["favorite",(C=e.value)!=null&&C.liked?"yep":""]),onClick:v(F,["prevent"])},[d(o,{icon:(T=e.value)!=null&&T.liked?s(ue):s(de)},null,8,["icon"])],10,Pe),a("a",{class:"prev",onClick:z},[d(o,{icon:s(ve)},null,8,["icon"])]),a("a",{class:"play-pause",onClick:v(M,["prevent"])},[d(o,{icon:$.value?s(_e):s(pe)},null,8,["icon"])],8,Ve),a("a",{class:"next",onClick:v(G,["prevent"])},[d(o,{icon:s(me)},null,8,["icon"])],8,xe),a("span",Le,[se(a("span",{id:"volumeSlider",ref_key:"volumeSlider",ref:u},null,512),[[le,m.value],[j,D]]),a("span",{class:"icon",onClick:v(B,["stop"])},[d(o,{icon:g.value?s(ye):s(ke),"fixed-width":""},null,8,["icon"])],8,Ke)])])],64)):(l(),i("div",Ue,[E.value?(l(),i("p",De,[ne(" No active Koel instance found. "),a("a",{class:"rescan text-highlight",onClick:v(Y,["prevent"])},"Rescan",8,Fe)])):(l(),i("div",Ie,Be))]))])],64)):(l(),i("div",Me,[d(s(U),{onLoggedin:R})]))],2)}}});he(ze).component("Icon",Se).directive("koel-clickaway",fe).mount("#app");
